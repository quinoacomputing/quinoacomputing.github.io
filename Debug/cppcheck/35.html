
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href=https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND>-128-NOTFOUND</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [<a href=https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND>-128-NOTFOUND</a>]: /tmp/TeamCity-1/work/5ad443c8abe7fc0a/src/PDE/EoS/GodunovRomenskiAluminum.cpp</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> GodunovRomenskiAluminum.cpp</p>
<a href="35.html#line-88"> unreadVariable 88</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/PDE/EoS/GodunovRomenskiAluminum.hpp</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015 J. Bakosi,</span>
<a name="line-5"></a><span class="cm">             2016-2018 Los Alamos National Security, LLC.,</span>
<a name="line-6"></a><span class="cm">             2019-2021 Triad National Security, LLC.</span>
<a name="line-7"></a><span class="cm">             All rights reserved. See the LICENSE file for details.</span>
<a name="line-8"></a><span class="cm">  \brief     Godunov-Romenski equation of state for solids</span>
<a name="line-9"></a><span class="cm">  \details   This file defines functions for the Godunov-Romenski equation of</span>
<a name="line-10"></a><span class="cm">             state for solids and a hydro EoS for aluminum. These function were</span>
<a name="line-11"></a><span class="cm">             taken from Barton, Philip T. &quot;An interface-capturing Godunov method</span>
<a name="line-12"></a><span class="cm">             for the simulation of compressible solid-fluid problems.&quot; Journal</span>
<a name="line-13"></a><span class="cm">             of Computational Physics 390 (2019): 25-50.</span>
<a name="line-14"></a><span class="cm">*/</span>
<a name="line-15"></a><span class="c1">// *****************************************************************************</span>
<a name="line-16"></a>
<a name="line-17"></a><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp"></span>
<a name="line-18"></a><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="line-19"></a><span class="cp">#include</span> <span class="cpf">&quot;Vector.hpp&quot;</span><span class="cp"></span>
<a name="line-20"></a><span class="cp">#include</span> <span class="cpf">&quot;EoS/GodunovRomenskiAluminum.hpp&quot;</span><span class="cp"></span>
<a name="line-21"></a><span class="cp">#include</span> <span class="cpf">&quot;EoS/GetMatProp.hpp&quot;</span><span class="cp"></span>
<a name="line-22"></a>
<a name="line-23"></a><span class="c1">// // Lapacke forward declarations</span>
<a name="line-24"></a><span class="c1">// extern &quot;C&quot; {</span>
<a name="line-25"></a>
<a name="line-26"></a><span class="c1">// using lapack_int = long;</span>
<a name="line-27"></a>
<a name="line-28"></a><span class="c1">// #define LAPACK_ROW_MAJOR 101</span>
<a name="line-29"></a>
<a name="line-30"></a><span class="c1">// lapack_int LAPACKE_dgeev(int, char, char, lapack_int, double*, lapack_int,</span>
<a name="line-31"></a><span class="c1">//   double*, double*, double*, lapack_int, double*, lapack_int );</span>
<a name="line-32"></a>
<a name="line-33"></a><span class="c1">// }</span>
<a name="line-34"></a>
<a name="line-35"></a><span class="k">static</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">e1</span> <span class="o">=</span> <span class="mf">-13.0e+09</span><span class="p">;</span>
<a name="line-36"></a><span class="k">static</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">e2</span> <span class="o">=</span> <span class="mf">20.0e+09</span><span class="p">;</span>
<a name="line-37"></a><span class="k">static</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">e3</span> <span class="o">=</span> <span class="mf">52.0e+09</span><span class="p">;</span>
<a name="line-38"></a><span class="k">static</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">e4</span> <span class="o">=</span> <span class="mf">-59.0e+09</span><span class="p">;</span>
<a name="line-39"></a><span class="k">static</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">e5</span> <span class="o">=</span> <span class="mf">151.0e+09</span><span class="p">;</span>
<a name="line-40"></a>
<a name="line-41"></a><span class="k">using</span> <span class="n">inciter</span><span class="o">::</span><span class="n">GodunovRomenskiAluminum</span><span class="p">;</span>
<a name="line-42"></a>
<a name="line-43"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">GodunovRomenskiAluminum</span><span class="p">(</span>
<a name="line-44"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">gamma</span><span class="p">,</span>
<a name="line-45"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">cv</span><span class="p">,</span>
<a name="line-46"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">mu</span> <span class="p">)</span> <span class="o">:</span>
<a name="line-47"></a>  <span class="n">m_gamma</span><span class="p">(</span><span class="n">gamma</span><span class="p">),</span>
<a name="line-48"></a>  <span class="n">m_cv</span><span class="p">(</span><span class="n">cv</span><span class="p">),</span>
<a name="line-49"></a>  <span class="n">m_mu</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
<a name="line-50"></a><span class="c1">// *************************************************************************</span>
<a name="line-51"></a><span class="c1">//  Constructor</span>
<a name="line-52"></a><span class="c1">//! \param[in] gamma Ratio of specific heats</span>
<a name="line-53"></a><span class="c1">//! \param[in] cv Specific heat at constant volume</span>
<a name="line-54"></a><span class="c1">//! \param[in] mu Constant shear modulus</span>
<a name="line-55"></a><span class="c1">// *************************************************************************</span>
<a name="line-56"></a><span class="p">{</span>
<a name="line-57"></a>  <span class="c1">// Since this is only for aluminum we hard set rho0</span>
<a name="line-58"></a>  <span class="n">m_rho0</span> <span class="o">=</span> <span class="mf">2700.0</span><span class="p">;</span>
<a name="line-59"></a><span class="p">}</span>
<a name="line-60"></a>
<a name="line-61"></a><span class="kt">void</span>
<a name="line-62"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">setRho0</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho0</span> <span class="p">)</span>
<a name="line-63"></a><span class="c1">// *************************************************************************</span>
<a name="line-64"></a><span class="c1">//  Set rho0 EOS parameter; i.e. the initial density</span>
<a name="line-65"></a><span class="c1">//! \param[in] rho0 Initial material density that needs to be stored</span>
<a name="line-66"></a><span class="c1">// *************************************************************************</span>
<a name="line-67"></a><span class="p">{</span>
<a name="line-68"></a>  <span class="n">m_rho0</span> <span class="o">=</span> <span class="n">rho0</span><span class="p">;</span>
<a name="line-69"></a><span class="p">}</span>
<a name="line-70"></a>
<a name="line-71"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-72"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">density</span><span class="p">(</span>
<a name="line-73"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">pr</span><span class="p">,</span>
<a name="line-74"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-75"></a><span class="c1">// *************************************************************************</span>
<a name="line-76"></a><span class="c1">//! \brief Calculate density from the material pressure and temperature</span>
<a name="line-77"></a><span class="c1">//!   using the GodunovRomenskiAluminum equation of state</span>
<a name="line-78"></a><span class="c1">//! \param[in] pr Material pressure</span>
<a name="line-79"></a><span class="c1">// //! \param[in] temp Material temperature</span>
<a name="line-80"></a><span class="c1">//! \return Material density calculated using the GodunovRomenskiAluminum EoS</span>
<a name="line-81"></a><span class="c1">// *************************************************************************</span>
<a name="line-82"></a><span class="p">{</span>
<a name="line-83"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho0</span> <span class="o">=</span> <span class="n">m_rho0</span><span class="p">;</span>
<a name="line-84"></a>  <span class="c1">// Quick Newton</span>
<a name="line-85"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">rho0</span><span class="p">;</span>
<a name="line-86"></a>  <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
<a name="line-87"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1.0e-04</span><span class="p">;</span>
<a name="line-88"></a><span class="hll">  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">err</span> <span class="o">=</span> <span class="n">tol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span><span class="error2">&lt;--- Variable 'err' is assigned a value that is never used.</span>
</span><a name="line-89"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">iter</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">iter</span><span class="o">&lt;</span><span class="n">maxiter</span><span class="p">;</span> <span class="o">++</span><span class="n">iter</span><span class="p">)</span>
<a name="line-90"></a>  <span class="p">{</span>
<a name="line-91"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">e2</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">)</span>
<a name="line-92"></a>               <span class="o">+</span> <span class="n">e3</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
<a name="line-93"></a>               <span class="o">-</span> <span class="n">e5</span><span class="o">*</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span> <span class="o">-</span> <span class="n">e4</span> <span class="o">-</span> <span class="n">pr</span><span class="p">;</span>
<a name="line-94"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">dpdrho</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">e2</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span><span class="o">/</span><span class="n">rho0</span>
<a name="line-95"></a>                    <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e3</span><span class="o">*</span><span class="n">rho</span><span class="o">/</span><span class="p">(</span><span class="n">rho0</span><span class="o">*</span><span class="n">rho0</span><span class="p">)</span> <span class="o">-</span> <span class="n">e5</span><span class="o">/</span><span class="n">rho0</span><span class="p">;</span>
<a name="line-96"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">p</span><span class="o">/</span><span class="n">dpdrho</span><span class="p">;</span>
<a name="line-97"></a>    <span class="n">rho</span> <span class="o">-=</span> <span class="n">delta</span><span class="p">;</span>
<a name="line-98"></a>    <span class="n">err</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">2.0</span><span class="p">));</span>
<a name="line-99"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
<a name="line-100"></a>  <span class="p">}</span>
<a name="line-101"></a>  <span class="k">return</span> <span class="n">rho</span><span class="p">;</span>
<a name="line-102"></a><span class="p">}</span>
<a name="line-103"></a>
<a name="line-104"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-105"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">pressure</span><span class="p">(</span>
<a name="line-106"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">arho</span><span class="p">,</span>
<a name="line-107"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-108"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-109"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-110"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-111"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">alpha</span><span class="p">,</span>
<a name="line-112"></a>  <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">imat</span><span class="p">,</span>
<a name="line-113"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-114"></a><span class="c1">// *************************************************************************</span>
<a name="line-115"></a><span class="c1">//! \brief Calculate pressure from the material density, momentum, total energy</span>
<a name="line-116"></a><span class="c1">//!   and the inverse deformation gradient tensor using the GodunovRomenskiAluminum</span>
<a name="line-117"></a><span class="c1">//!   equation of state</span>
<a name="line-118"></a><span class="c1">//! \param[in] arho Material partial density (alpha_k * rho_k)</span>
<a name="line-119"></a><span class="c1">// //! \param[in] u X-velocity</span>
<a name="line-120"></a><span class="c1">// //! \param[in] v Y-velocity</span>
<a name="line-121"></a><span class="c1">// //! \param[in] w Z-velocity</span>
<a name="line-122"></a><span class="c1">// //! \param[in] arhoE Material total energy (alpha_k * rho_k * E_k)</span>
<a name="line-123"></a><span class="c1">//! \param[in] alpha Material volume fraction. Default is 1.0, so that for</span>
<a name="line-124"></a><span class="c1">//!   the single-material system, this argument can be left unspecified by</span>
<a name="line-125"></a><span class="c1">//!   the calling code</span>
<a name="line-126"></a><span class="c1">//! \param[in] imat Material-id who&#39;s EoS is required. Default is 0, so that</span>
<a name="line-127"></a><span class="c1">//!   for the single-material system, this argument can be left unspecified</span>
<a name="line-128"></a><span class="c1">//!   by the calling code</span>
<a name="line-129"></a><span class="c1">// //! \param[in] defgrad Material inverse deformation gradient tensor</span>
<a name="line-130"></a><span class="c1">// //!   (g_k). Default is 0, so that for the single-material system,</span>
<a name="line-131"></a><span class="c1">// //!   this argument can be left unspecified by the calling code</span>
<a name="line-132"></a><span class="c1">//! \return Material partial pressure (alpha_k * p_k) calculated using the</span>
<a name="line-133"></a><span class="c1">//!   GodunovRomenskiAluminum EoS</span>
<a name="line-134"></a><span class="c1">// *************************************************************************</span>
<a name="line-135"></a><span class="p">{</span>
<a name="line-136"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho0</span> <span class="o">=</span> <span class="n">m_rho0</span><span class="p">;</span>
<a name="line-137"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">arho</span><span class="o">/</span><span class="n">alpha</span><span class="p">;</span>
<a name="line-138"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">partpressure</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">e2</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">)</span>
<a name="line-139"></a>                                 <span class="o">+</span> <span class="n">e3</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
<a name="line-140"></a>                                 <span class="o">-</span> <span class="n">e5</span><span class="o">*</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span> <span class="o">-</span> <span class="n">e4</span> <span class="p">);</span>
<a name="line-141"></a>
<a name="line-142"></a>  <span class="c1">// check partial pressure divergence</span>
<a name="line-143"></a>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">std</span><span class="o">::</span><span class="n">isfinite</span><span class="p">(</span><span class="n">partpressure</span><span class="p">))</span> <span class="p">{</span>
<a name="line-144"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Material-id:      &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">imat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-145"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Volume-fraction:  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">alpha</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-146"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Partial density:  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">arho</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-147"></a>    <span class="n">Throw</span><span class="p">(</span><span class="s">&quot;Material-&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">imat</span><span class="p">)</span> <span class="o">+</span>
<a name="line-148"></a>      <span class="s">&quot; has nan/inf partial pressure: &quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">partpressure</span><span class="p">)</span> <span class="o">+</span>
<a name="line-149"></a>      <span class="s">&quot;, material volume fraction: &quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">alpha</span><span class="p">));</span>
<a name="line-150"></a>  <span class="p">}</span>
<a name="line-151"></a>
<a name="line-152"></a>  <span class="k">return</span> <span class="n">partpressure</span><span class="p">;</span>
<a name="line-153"></a><span class="p">}</span>
<a name="line-154"></a>
<a name="line-155"></a><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span>
<a name="line-156"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">CauchyStress</span><span class="p">(</span>
<a name="line-157"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-158"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-159"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-160"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-161"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-162"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">alpha</span><span class="p">,</span>
<a name="line-163"></a>  <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="cm">/*imat*/</span><span class="p">,</span>
<a name="line-164"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">defgrad</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-165"></a><span class="c1">// *************************************************************************</span>
<a name="line-166"></a><span class="c1">//! \brief Calculate the elastic Cauchy stress tensor from the material density,</span>
<a name="line-167"></a><span class="c1">//!   momentum, total energy, and inverse deformation gradient tensor using the</span>
<a name="line-168"></a><span class="c1">//!   GodunovRomenskiAluminum equation of state</span>
<a name="line-169"></a><span class="c1">//! \param[in] alpha Material volume fraction. Default is 1.0, so that for</span>
<a name="line-170"></a><span class="c1">//!   the single-material system, this argument can be left unspecified by</span>
<a name="line-171"></a><span class="c1">//!   the calling code</span>
<a name="line-172"></a><span class="c1">// //! \param[in] imat Material-id who&#39;s EoS is required. Default is 0, so that</span>
<a name="line-173"></a><span class="c1">// //!   for the single-material system, this argument can be left unspecified</span>
<a name="line-174"></a><span class="c1">// //!   by the calling code</span>
<a name="line-175"></a><span class="c1">//! \param[in] defgrad Material inverse deformation gradient tensor (g_k).</span>
<a name="line-176"></a><span class="c1">//! \return Material Cauchy stress tensor (alpha_k * sigma_k) calculated using</span>
<a name="line-177"></a><span class="c1">//!   the GodunovRomenskiAluminum EoS</span>
<a name="line-178"></a><span class="c1">// *************************************************************************</span>
<a name="line-179"></a><span class="p">{</span>
<a name="line-180"></a>  <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">asig</span><span class="p">{{{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">}}};</span>
<a name="line-181"></a>
<a name="line-182"></a>  <span class="c1">// obtain elastic contribution to energy and substract it from pmean</span>
<a name="line-183"></a>  <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">devH</span><span class="p">;</span>
<a name="line-184"></a>
<a name="line-185"></a>  <span class="c1">// p_mean</span>
<a name="line-186"></a>  <span class="k">auto</span> <span class="n">pmean</span> <span class="o">=</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">elasticEnergy</span><span class="p">(</span><span class="n">defgrad</span><span class="p">,</span> <span class="n">devH</span><span class="p">);</span>
<a name="line-187"></a>
<a name="line-188"></a>  <span class="c1">// Volumetric component of Cauchy stress tensor</span>
<a name="line-189"></a>  <span class="n">asig</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pmean</span><span class="p">;</span>
<a name="line-190"></a>  <span class="n">asig</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pmean</span><span class="p">;</span>
<a name="line-191"></a>  <span class="n">asig</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pmean</span><span class="p">;</span>
<a name="line-192"></a>
<a name="line-193"></a>  <span class="c1">// Add deviatoric component of Cauchy stress tensor</span>
<a name="line-194"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<a name="line-195"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
<a name="line-196"></a>      <span class="n">asig</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">m_mu</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">devH</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<a name="line-197"></a>  <span class="p">}</span>
<a name="line-198"></a>
<a name="line-199"></a>  <span class="k">return</span> <span class="n">asig</span><span class="p">;</span>
<a name="line-200"></a><span class="p">}</span>
<a name="line-201"></a>
<a name="line-202"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-203"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">soundspeed</span><span class="p">(</span>
<a name="line-204"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">arho</span><span class="p">,</span>
<a name="line-205"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">apr</span><span class="p">,</span>
<a name="line-206"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">alpha</span><span class="p">,</span>
<a name="line-207"></a>  <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">imat</span><span class="p">,</span>
<a name="line-208"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="cm">/*defgrad*/</span><span class="p">,</span>
<a name="line-209"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="cm">/*adefgradn*/</span><span class="p">,</span>
<a name="line-210"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="cm">/*asigman*/</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-211"></a><span class="c1">// *************************************************************************</span>
<a name="line-212"></a><span class="c1">//! Calculate speed of sound from the material density and material pressure</span>
<a name="line-213"></a><span class="c1">//! \param[in] arho Material partial density (alpha_k * rho_k)</span>
<a name="line-214"></a><span class="c1">//! \param[in] apr Material partial pressure (alpha_k * p_k)</span>
<a name="line-215"></a><span class="c1">//! \param[in] alpha Material volume fraction. Default is 1.0, so that for</span>
<a name="line-216"></a><span class="c1">//!   the single-material system, this argument can be left unspecified by</span>
<a name="line-217"></a><span class="c1">//!   the calling code</span>
<a name="line-218"></a><span class="c1">//! \param[in] imat Material-id who&#39;s EoS is required. Default is 0, so that</span>
<a name="line-219"></a><span class="c1">//!   for the single-material system, this argument can be left unspecified</span>
<a name="line-220"></a><span class="c1">//!   by the calling code</span>
<a name="line-221"></a><span class="c1">//!   (alpha * sigma_ij * n_j) projected onto the normal vector. Default is 0,</span>
<a name="line-222"></a><span class="c1">//!   so that for the single-material system, this argument can be left</span>
<a name="line-223"></a><span class="c1">//!   unspecified by the calling code</span>
<a name="line-224"></a><span class="c1">//! \param[in] defgrad Material inverse deformation gradient tensor</span>
<a name="line-225"></a><span class="c1">//!   (g_k) with the first dimension aligned to direction in which</span>
<a name="line-226"></a><span class="c1">//!   wave speeds are required. Default is 0, so that for the single-material</span>
<a name="line-227"></a><span class="c1">//!   system, this argument can be left unspecified by the calling code</span>
<a name="line-228"></a><span class="c1">//  //! \param[in] adefgradn Material inverse deformation gradient tensor in</span>
<a name="line-229"></a><span class="c1">//  //!   direction of vector n (alpha_k * g_ij * n_j). Default is 0, so that for</span>
<a name="line-230"></a><span class="c1">//  //!   the single-material system, this argument can be left unspecified by the</span>
<a name="line-231"></a><span class="c1">//  //!   calling code</span>
<a name="line-232"></a><span class="c1">//  //! \param[in] asigman Material traction vector in normal direction</span>
<a name="line-233"></a><span class="c1">//  //!   (alpha * sigma_ij * n_j ). Default is 0, so that for the single-material</span>
<a name="line-234"></a><span class="c1">//  //!   system, this argument can be left unspecified by the calling code</span>
<a name="line-235"></a><span class="c1">//! \return Material speed of sound using the GodunovRomenskiAluminum EoS</span>
<a name="line-236"></a><span class="c1">// *************************************************************************</span>
<a name="line-237"></a><span class="p">{</span>
<a name="line-238"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<a name="line-239"></a>
<a name="line-240"></a>  <span class="c1">// Hydro contribution</span>
<a name="line-241"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho0</span> <span class="o">=</span> <span class="n">m_rho0</span><span class="p">;</span>
<a name="line-242"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">arho</span><span class="o">/</span><span class="n">alpha</span><span class="p">;</span>
<a name="line-243"></a>  <span class="n">a</span> <span class="o">+=</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span> <span class="mf">1.0e-15</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">e2</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span><span class="o">/</span><span class="n">rho0</span>
<a name="line-244"></a>                 <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e3</span><span class="o">*</span><span class="n">rho</span><span class="o">/</span><span class="p">(</span><span class="n">rho0</span><span class="o">*</span><span class="n">rho0</span><span class="p">)</span> <span class="o">-</span> <span class="n">e5</span><span class="o">/</span><span class="n">rho0</span> <span class="p">);</span>
<a name="line-245"></a>
<a name="line-246"></a>  <span class="c1">// Shear contribution</span>
<a name="line-247"></a>  <span class="n">a</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">m_mu</span> <span class="o">/</span> <span class="p">(</span><span class="n">arho</span><span class="o">/</span><span class="n">alpha</span><span class="p">);</span>
<a name="line-248"></a>
<a name="line-249"></a>  <span class="c1">// Compute square root</span>
<a name="line-250"></a>  <span class="n">a</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<a name="line-251"></a>
<a name="line-252"></a>  <span class="c1">// check sound speed divergence</span>
<a name="line-253"></a>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">std</span><span class="o">::</span><span class="n">isfinite</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="p">{</span>
<a name="line-254"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Material-id:      &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">imat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-255"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Volume-fraction:  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">alpha</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-256"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Partial density:  &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">arho</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-257"></a>    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Partial pressure: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">apr</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-258"></a>    <span class="n">Throw</span><span class="p">(</span><span class="s">&quot;Material-&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">imat</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; has nan/inf sound speed: &quot;</span>
<a name="line-259"></a>      <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;, material volume fraction: &quot;</span> <span class="o">+</span>
<a name="line-260"></a>      <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">alpha</span><span class="p">));</span>
<a name="line-261"></a>  <span class="p">}</span>
<a name="line-262"></a>
<a name="line-263"></a>  <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
<a name="line-264"></a><span class="p">}</span>
<a name="line-265"></a>
<a name="line-266"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-267"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">totalenergy</span><span class="p">(</span>
<a name="line-268"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho</span><span class="p">,</span>
<a name="line-269"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-270"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-271"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-272"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-273"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">defgrad</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-274"></a><span class="c1">// *************************************************************************</span>
<a name="line-275"></a><span class="c1">//! \brief Calculate material specific total energy from the material</span>
<a name="line-276"></a><span class="c1">//!   density, momentum and material pressure</span>
<a name="line-277"></a><span class="c1">//! \param[in] rho Material density</span>
<a name="line-278"></a><span class="c1">// //! \param[in] u X-velocity</span>
<a name="line-279"></a><span class="c1">// //! \param[in] v Y-velocity</span>
<a name="line-280"></a><span class="c1">// //! \param[in] w Z-velocity</span>
<a name="line-281"></a><span class="c1">// //! \param[in] pr Material pressure</span>
<a name="line-282"></a><span class="c1">//! \param[in] defgrad Material inverse deformation gradient tensor</span>
<a name="line-283"></a><span class="c1">//!   g_k. Default is 0, so that for the single-material system,</span>
<a name="line-284"></a><span class="c1">//!   this argument can be left unspecified by the calling code</span>
<a name="line-285"></a><span class="c1">//! \return Material specific total energy using the GodunovRomenskiAluminum EoS</span>
<a name="line-286"></a><span class="c1">// *************************************************************************</span>
<a name="line-287"></a><span class="p">{</span>
<a name="line-288"></a>  <span class="c1">// obtain hydro contribution to energy</span>
<a name="line-289"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho0</span> <span class="o">=</span> <span class="n">m_rho0</span><span class="p">;</span>
<a name="line-290"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rhoEh</span> <span class="o">=</span> <span class="p">(</span><span class="n">e1</span><span class="o">+</span><span class="n">e2</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span><span class="o">+</span><span class="n">e3</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">)</span>
<a name="line-291"></a>                    <span class="o">+</span><span class="n">e4</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">pow</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">,</span><span class="mf">-1.0</span><span class="p">)</span><span class="o">-</span><span class="n">e5</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="n">rho0</span><span class="p">))</span><span class="o">/</span><span class="n">rho0</span><span class="p">;</span>
<a name="line-292"></a>  <span class="c1">// obtain elastic contribution to energy</span>
<a name="line-293"></a>  <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">devH</span><span class="p">;</span>
<a name="line-294"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rhoEe</span> <span class="o">=</span> <span class="n">elasticEnergy</span><span class="p">(</span><span class="n">defgrad</span><span class="p">,</span> <span class="n">devH</span><span class="p">);</span>
<a name="line-295"></a>
<a name="line-296"></a>  <span class="k">return</span> <span class="p">(</span><span class="n">rhoEh</span> <span class="o">+</span> <span class="n">rhoEe</span><span class="p">);</span>
<a name="line-297"></a><span class="p">}</span>
<a name="line-298"></a>
<a name="line-299"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-300"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">temperature</span><span class="p">(</span>
<a name="line-301"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-302"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-303"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-304"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-305"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-306"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-307"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-308"></a><span class="c1">// *************************************************************************</span>
<a name="line-309"></a><span class="c1">//! \brief Calculate material temperature from the material density, and</span>
<a name="line-310"></a><span class="c1">//!   material specific total energy</span>
<a name="line-311"></a><span class="c1">// //! \param[in] arho Material partial density (alpha_k * rho_k)</span>
<a name="line-312"></a><span class="c1">// //! \param[in] u X-velocity</span>
<a name="line-313"></a><span class="c1">// //! \param[in] v Y-velocity</span>
<a name="line-314"></a><span class="c1">// //! \param[in] w Z-velocity</span>
<a name="line-315"></a><span class="c1">// //! \param[in] arhoE Material total energy (alpha_k * rho_k * E_k)</span>
<a name="line-316"></a><span class="c1">// //! \param[in] alpha Material volume fraction. Default is 1.0, so that for</span>
<a name="line-317"></a><span class="c1">// //!   the single-material system, this argument can be left unspecified by</span>
<a name="line-318"></a><span class="c1">// //!   the calling code</span>
<a name="line-319"></a><span class="c1">// //! \param[in] defgrad Material inverse deformation gradient tensor</span>
<a name="line-320"></a><span class="c1">// //!   (g_k). Default is 0, so that for the single-material system,</span>
<a name="line-321"></a><span class="c1">// //!   this argument can be left unspecified by the calling code</span>
<a name="line-322"></a><span class="c1">//! \return Material temperature using the GodunovRomenskiAluminum EoS</span>
<a name="line-323"></a><span class="c1">// *************************************************************************</span>
<a name="line-324"></a><span class="p">{</span>
<a name="line-325"></a>  <span class="c1">// Temperature does not directly contribute to energy</span>
<a name="line-326"></a>  <span class="c1">// So we just set a value.</span>
<a name="line-327"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">t</span> <span class="o">=</span> <span class="mf">300.0</span><span class="p">;</span>
<a name="line-328"></a>
<a name="line-329"></a>  <span class="k">return</span> <span class="n">t</span><span class="p">;</span>
<a name="line-330"></a><span class="p">}</span>
<a name="line-331"></a>
<a name="line-332"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-333"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">min_eff_pressure</span><span class="p">(</span>
<a name="line-334"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">min</span><span class="p">,</span>
<a name="line-335"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-336"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-337"></a><span class="c1">// *************************************************************************</span>
<a name="line-338"></a><span class="c1">//! Compute the minimum allowed pressure</span>
<a name="line-339"></a><span class="c1">//! \param[in] min Numerical threshold above which pressure needs to be limited</span>
<a name="line-340"></a><span class="c1">//! \return Minimum pressure allowed by physical constraints</span>
<a name="line-341"></a><span class="c1">// *************************************************************************</span>
<a name="line-342"></a><span class="p">{</span>
<a name="line-343"></a>  <span class="c1">// minimum pressure is constrained by zero soundspeed.</span>
<a name="line-344"></a>  <span class="k">return</span> <span class="n">min</span><span class="p">;</span>
<a name="line-345"></a><span class="p">}</span>
<a name="line-346"></a>
<a name="line-347"></a><span class="n">tk</span><span class="o">::</span><span class="n">real</span>
<a name="line-348"></a><span class="n">GodunovRomenskiAluminum</span><span class="o">::</span><span class="n">elasticEnergy</span><span class="p">(</span>
<a name="line-349"></a>  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">defgrad</span><span class="p">,</span>
<a name="line-350"></a>  <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">devH</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-351"></a><span class="c1">// *************************************************************************</span>
<a name="line-352"></a><span class="c1">//! \brief Calculate elastic contribution to material energy from the material</span>
<a name="line-353"></a><span class="c1">//!   density, and deformation gradient tensor</span>
<a name="line-354"></a><span class="c1">//! \param[in] defgrad Material inverse deformation gradient tensor</span>
<a name="line-355"></a><span class="c1">//! \param[in/out] devH Deviatoric part of the Hensky tensor</span>
<a name="line-356"></a><span class="c1">//! \return Material elastic energy using the GodunovRomenskiAluminum EoS</span>
<a name="line-357"></a><span class="c1">//! \details This function returns the material elastic energy, and also stores</span>
<a name="line-358"></a><span class="c1">//!   the elastic shear distortion for further use</span>
<a name="line-359"></a><span class="c1">// *************************************************************************</span>
<a name="line-360"></a><span class="p">{</span>
<a name="line-361"></a>  <span class="c1">// Compute deviatoric part of Hencky tensor</span>
<a name="line-362"></a>  <span class="n">devH</span> <span class="o">=</span> <span class="n">tk</span><span class="o">::</span><span class="n">getDevHencky</span><span class="p">(</span><span class="n">defgrad</span><span class="p">);</span>
<a name="line-363"></a>
<a name="line-364"></a>  <span class="c1">// Compute elastic energy</span>
<a name="line-365"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rhoEe</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<a name="line-366"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<a name="line-367"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
<a name="line-368"></a>      <span class="n">rhoEe</span> <span class="o">+=</span> <span class="n">m_mu</span><span class="o">*</span><span class="n">devH</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">devH</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<a name="line-369"></a>
<a name="line-370"></a>  <span class="k">return</span> <span class="n">rhoEe</span><span class="p">;</span>
<a name="line-371"></a><span class="p">}</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
