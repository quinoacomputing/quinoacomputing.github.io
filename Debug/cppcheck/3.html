
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href=https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND>-128-NOTFOUND</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [<a href=https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND>-128-NOTFOUND</a>]: /tmp/TeamCity-2/work/5ad443c8abe7fc0a/src/IO/RootMeshWriter.cpp</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> RootMeshWriter.cpp</p>
<a href="3.html#line-37"> noCopyConstructor 37</a><a href="3.html#line-37"> noOperatorEq 37</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/IO/RootMeshWriter.cpp</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015 J. Bakosi,</span>
<a name="line-5"></a><span class="cm">             2016-2018 Los Alamos National Security, LLC.,</span>
<a name="line-6"></a><span class="cm">             2019-2021 Triad National Security, LLC.</span>
<a name="line-7"></a><span class="cm">             All rights reserved. See the LICENSE file for details.</span>
<a name="line-8"></a><span class="cm">  \brief     Root mesh-based data writer</span>
<a name="line-9"></a><span class="cm">  \details   Root mesh-based data writer class definition.</span>
<a name="line-10"></a><span class="cm">*/</span>
<a name="line-11"></a><span class="c1">// *****************************************************************************</span>
<a name="line-12"></a>
<a name="line-13"></a><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<a name="line-14"></a><span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span><span class="cp"></span>
<a name="line-15"></a><span class="cp">#include</span> <span class="cpf">&lt;iterator&gt;</span><span class="cp"></span>
<a name="line-16"></a><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<a name="line-17"></a><span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span><span class="cp"></span>
<a name="line-18"></a>
<a name="line-19"></a><span class="cp">#include</span> <span class="cpf">&quot;RootMeshWriter.hpp&quot;</span><span class="cp"></span>
<a name="line-20"></a><span class="cp">#include</span> <span class="cpf">&quot;Exception.hpp&quot;</span><span class="cp"></span>
<a name="line-21"></a><span class="cp">#include</span> <span class="cpf">&quot;UnsMesh.hpp&quot;</span><span class="cp"></span>
<a name="line-22"></a>
<a name="line-23"></a><span class="k">using</span> <span class="n">tk</span><span class="o">::</span><span class="n">RootMeshWriter</span><span class="p">;</span>
<a name="line-24"></a>
<a name="line-25"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">RootMeshWriter</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">filename</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span> <span class="p">)</span> <span class="o">:</span>
<a name="line-26"></a>  <span class="n">m_filename</span><span class="p">(</span> <span class="n">filename</span> <span class="p">)</span>
<a name="line-27"></a><span class="c1">// *****************************************************************************</span>
<a name="line-28"></a><span class="c1">//  Constructor: create/open Root file</span>
<a name="line-29"></a><span class="c1">//! \param[in] &quot;filename&quot; File to open as Root file</span>
<a name="line-30"></a><span class="c1">//! \param[in] mode Root writer constructor mode: ExoWriter::CREATE for</span>
<a name="line-31"></a><span class="c1">//!   creating a new file, ExoWriter::OPEN for opening an existing file for</span>
<a name="line-32"></a><span class="c1">//!   appending</span>
<a name="line-33"></a><span class="c1">// *****************************************************************************</span>
<a name="line-34"></a><span class="p">{</span>
<a name="line-35"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
<a name="line-36"></a>
<a name="line-37"></a><span class="hll">    <span class="n">m_rfile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span> <span class="n">filename</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="s">&quot;RECREATE&quot;</span> <span class="p">);</span><span class="error2">&lt;--- Class 'RootMeshWriter' does not have a copy constructor which is recommended since it has dynamic memory/resource allocation(s).</span><span class="error2">&lt;--- Class 'RootMeshWriter' does not have a operator= which is recommended since it has dynamic memory/resource allocation(s).</span>
</span><a name="line-38"></a>    <span class="n">m_tree_connect</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TTree</span> <span class="p">(</span> <span class="s">&quot;ctree&quot;</span><span class="p">,</span> <span class="s">&quot;store the connectivity&quot;</span> <span class="p">);</span>
<a name="line-39"></a>
<a name="line-40"></a>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<a name="line-41"></a>
<a name="line-42"></a>      <span class="n">m_rfile</span> <span class="o">=</span> <span class="n">TFile</span><span class="o">::</span><span class="n">Open</span><span class="p">(</span> <span class="n">filename</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="s">&quot;UPDATE&quot;</span> <span class="p">);</span>
<a name="line-43"></a>      <span class="n">m_tree_connect</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">TTree</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">m_rfile</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span> <span class="s">&quot;ctree&quot;</span> <span class="p">)</span> <span class="p">);</span>
<a name="line-44"></a>
<a name="line-45"></a>  <span class="p">}</span> <span class="k">else</span> <span class="n">Throw</span><span class="p">(</span> <span class="s">&quot;Root Mesh modes not supported&quot;</span> <span class="p">);</span>
<a name="line-46"></a><span class="p">}</span>
<a name="line-47"></a>
<a name="line-48"></a><span class="n">RootMeshWriter</span><span class="o">::~</span><span class="n">RootMeshWriter</span><span class="p">()</span> <span class="k">noexcept</span>
<a name="line-49"></a><span class="c1">// *****************************************************************************</span>
<a name="line-50"></a><span class="c1">//  Destructor</span>
<a name="line-51"></a><span class="c1">// *****************************************************************************</span>
<a name="line-52"></a><span class="p">{</span>
<a name="line-53"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">m_rfile</span><span class="p">)</span> <span class="p">{</span>
<a name="line-54"></a>    <span class="n">m_rfile</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">();</span>
<a name="line-55"></a>    <span class="n">m_rfile</span><span class="o">-&gt;</span><span class="n">Close</span><span class="p">();</span>
<a name="line-56"></a>  <span class="p">}</span>
<a name="line-57"></a><span class="p">}</span>
<a name="line-58"></a>
<a name="line-59"></a><span class="kt">void</span>
<a name="line-60"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeMesh</span><span class="p">(</span> <span class="k">const</span> <span class="n">UnsMesh</span><span class="o">&amp;</span> <span class="n">mesh</span> <span class="p">)</span>
<a name="line-61"></a><span class="c1">// *****************************************************************************</span>
<a name="line-62"></a><span class="c1">//  Write Root mesh file</span>
<a name="line-63"></a><span class="c1">//! \param[in] mesh Unstructured mesh object</span>
<a name="line-64"></a><span class="c1">// *****************************************************************************</span>
<a name="line-65"></a><span class="p">{</span>
<a name="line-66"></a>  <span class="n">writeHeader</span><span class="p">(</span> <span class="n">mesh</span> <span class="p">);</span>
<a name="line-67"></a>  <span class="n">writeNodes</span><span class="p">(</span> <span class="n">mesh</span> <span class="p">);</span>
<a name="line-68"></a>  <span class="n">writeElements</span><span class="p">(</span> <span class="n">mesh</span> <span class="p">);</span>
<a name="line-69"></a><span class="p">}</span>
<a name="line-70"></a>
<a name="line-71"></a><span class="kt">void</span>
<a name="line-72"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeHeader</span><span class="p">(</span> <span class="k">const</span> <span class="n">UnsMesh</span><span class="o">&amp;</span> <span class="n">mesh</span> <span class="p">)</span>
<a name="line-73"></a><span class="c1">// *****************************************************************************</span>
<a name="line-74"></a><span class="c1">//  Write Root header</span>
<a name="line-75"></a><span class="c1">//! \param[in] mesh Unstructured mesh object</span>
<a name="line-76"></a><span class="c1">// *****************************************************************************</span>
<a name="line-77"></a><span class="p">{</span>
<a name="line-78"></a>
<a name="line-79"></a>  <span class="n">m_csobject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">mesh_data</span><span class="p">(</span> <span class="n">mesh</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
<a name="line-80"></a>                            <span class="n">mesh</span><span class="p">.</span><span class="n">tetinpoel</span><span class="p">().</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="n">mesh</span><span class="p">.</span><span class="n">triinpoel</span><span class="p">().</span><span class="n">size</span><span class="p">()</span> <span class="p">);</span>
<a name="line-81"></a>
<a name="line-82"></a><span class="p">}</span>
<a name="line-83"></a>
<a name="line-84"></a><span class="kt">void</span>
<a name="line-85"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeNodes</span><span class="p">(</span> <span class="k">const</span> <span class="n">UnsMesh</span><span class="o">&amp;</span> <span class="n">mesh</span> <span class="p">)</span>
<a name="line-86"></a><span class="c1">// *****************************************************************************</span>
<a name="line-87"></a><span class="c1">//  Write node coordinates to Root file</span>
<a name="line-88"></a><span class="c1">//! \param[in] mesh Unstructured mesh object</span>
<a name="line-89"></a><span class="c1">// *****************************************************************************</span>
<a name="line-90"></a><span class="p">{</span>
<a name="line-91"></a>  <span class="c1">// the file requires the vertices and the number of triangles</span>
<a name="line-92"></a>  <span class="c1">// 4 triangles per tetrahedron and mesh.tetinpoel() stores 4 </span>
<a name="line-93"></a>  <span class="c1">// vertices per tet in the vector (# vertices = # of triangles)</span>
<a name="line-94"></a>
<a name="line-95"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;coord&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">coordinates</span><span class="p">,</span> <span class="s">&quot;coordinates/I&quot;</span> <span class="p">);</span>
<a name="line-96"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;trian&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">triangles</span><span class="p">,</span> <span class="s">&quot;triangles/I&quot;</span> <span class="p">);</span>
<a name="line-97"></a>  
<a name="line-98"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;x_coord&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">mx_root</span> <span class="p">);</span>
<a name="line-99"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;y_coord&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">my_root</span> <span class="p">);</span>
<a name="line-100"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;z_coord&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">mz_root</span> <span class="p">);</span>
<a name="line-101"></a>
<a name="line-102"></a>  <span class="k">auto</span> <span class="n">c</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">coordinates</span> <span class="p">);</span>
<a name="line-103"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">c</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<a name="line-104"></a>    <span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">mx_root</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">mesh</span><span class="p">.</span><span class="n">x</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
<a name="line-105"></a>    <span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">my_root</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">mesh</span><span class="p">.</span><span class="n">y</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
<a name="line-106"></a>    <span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">mz_root</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">mesh</span><span class="p">.</span><span class="n">z</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
<a name="line-107"></a>  <span class="p">}</span>
<a name="line-108"></a><span class="p">}</span>
<a name="line-109"></a>
<a name="line-110"></a><span class="kt">void</span>
<a name="line-111"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeElements</span><span class="p">(</span> <span class="k">const</span> <span class="n">UnsMesh</span><span class="o">&amp;</span> <span class="n">mesh</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-112"></a><span class="c1">// *****************************************************************************</span>
<a name="line-113"></a><span class="c1">//  Write element connectivity to Root file</span>
<a name="line-114"></a><span class="c1">//! \param[in] mesh Unstructured mesh object</span>
<a name="line-115"></a><span class="c1">// *****************************************************************************</span>
<a name="line-116"></a><span class="p">{</span>
<a name="line-117"></a>  <span class="kt">int</span> <span class="n">elclass</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<a name="line-118"></a>
<a name="line-119"></a>  <span class="n">writeElemBlock</span><span class="p">(</span> <span class="n">elclass</span><span class="p">,</span> <span class="n">mesh</span><span class="p">.</span><span class="n">triinpoel</span><span class="p">()</span> <span class="p">);</span>
<a name="line-120"></a>  <span class="n">writeElemBlock</span><span class="p">(</span> <span class="n">elclass</span><span class="p">,</span> <span class="n">mesh</span><span class="p">.</span><span class="n">tetinpoel</span><span class="p">()</span> <span class="p">);</span>
<a name="line-121"></a><span class="p">}</span>
<a name="line-122"></a>
<a name="line-123"></a><span class="kt">void</span>
<a name="line-124"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeElemBlock</span><span class="p">(</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">elclass</span><span class="p">,</span>
<a name="line-125"></a>                                <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span> <span class="p">)</span>
<a name="line-126"></a><span class="k">const</span>
<a name="line-127"></a><span class="c1">// *****************************************************************************</span>
<a name="line-128"></a><span class="c1">//  Write element block to ROOT file</span>
<a name="line-129"></a><span class="c1">//! \param[inout] elclass Count element class ids in file</span>
<a name="line-130"></a><span class="c1">//! \param[in] inpoel Element connectivity.</span>
<a name="line-131"></a><span class="c1">// *****************************************************************************</span>
<a name="line-132"></a><span class="p">{</span>
<a name="line-133"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">inpoel</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>
<a name="line-134"></a>
<a name="line-135"></a>  <span class="c1">// increase number of element classes in file</span>
<a name="line-136"></a>  <span class="o">++</span><span class="n">elclass</span><span class="p">;</span>
<a name="line-137"></a>
<a name="line-138"></a>  <span class="c1">// Make sure element connectivity starts with zero</span>
<a name="line-139"></a>  <span class="n">Assert</span><span class="p">(</span> <span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">minmax_element</span><span class="p">(</span> <span class="n">begin</span><span class="p">(</span><span class="n">inpoel</span><span class="p">),</span> <span class="n">end</span><span class="p">(</span><span class="n">inpoel</span><span class="p">)</span> <span class="p">).</span><span class="n">first</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
<a name="line-140"></a>          <span class="s">&quot;node ids should start from zero&quot;</span> <span class="p">);</span>
<a name="line-141"></a>  
<a name="line-142"></a>  <span class="c1">// create a branch for storing the tetrahedrons  </span>
<a name="line-143"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;tetconnect&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">tet_connect</span> <span class="p">);</span>
<a name="line-144"></a>  <span class="k">for</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">itr</span> <span class="o">=</span> <span class="n">inpoel</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">itr</span> <span class="o">!=</span> <span class="n">inpoel</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">itr</span><span class="o">++</span> <span class="p">)</span>
<a name="line-145"></a>    <span class="n">m_csobject</span><span class="o">-&gt;</span><span class="n">tet_connect</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="o">*</span><span class="n">itr</span> <span class="p">);</span>
<a name="line-146"></a>
<a name="line-147"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Fill</span><span class="p">();</span>
<a name="line-148"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">();</span> 
<a name="line-149"></a>
<a name="line-150"></a><span class="p">}</span>
<a name="line-151"></a>
<a name="line-152"></a><span class="kt">void</span>
<a name="line-153"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeNodeVarNames</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&gt;&amp;</span> <span class="n">nv</span> <span class="p">)</span>
<a name="line-154"></a><span class="k">const</span>
<a name="line-155"></a><span class="c1">// *****************************************************************************</span>
<a name="line-156"></a><span class="c1">//  Write the names of nodal output variables to ROOT file</span>
<a name="line-157"></a><span class="c1">//! \param[in] nv Nodal variable names</span>
<a name="line-158"></a><span class="c1">// *****************************************************************************</span>
<a name="line-159"></a><span class="p">{</span>
<a name="line-160"></a>  <span class="n">std</span><span class="o">::</span><span class="n">vector</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&gt;</span> <span class="n">nv_copy</span><span class="p">;</span>
<a name="line-161"></a>  <span class="n">TBranch</span> <span class="o">*</span><span class="n">branch</span> <span class="o">=</span> <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="s">&quot;variables&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nv_copy</span> <span class="p">);</span>
<a name="line-162"></a>
<a name="line-163"></a>  <span class="k">for</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">itr</span> <span class="o">=</span> <span class="n">nv</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">itr</span> <span class="o">!=</span> <span class="n">nv</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">itr</span><span class="o">++</span><span class="p">)</span>
<a name="line-164"></a>    <span class="n">nv_copy</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="o">*</span><span class="n">itr</span> <span class="p">);</span>
<a name="line-165"></a>
<a name="line-166"></a>  <span class="n">branch</span><span class="o">-&gt;</span><span class="n">Fill</span><span class="p">();</span>
<a name="line-167"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">();</span>
<a name="line-168"></a>
<a name="line-169"></a><span class="p">}</span>
<a name="line-170"></a>
<a name="line-171"></a><span class="kt">void</span>
<a name="line-172"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeTimeStamp</span><span class="p">(</span> <span class="kt">uint64_t</span> <span class="n">it</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">time</span> <span class="p">)</span>
<a name="line-173"></a><span class="c1">// *****************************************************************************</span>
<a name="line-174"></a><span class="c1">//  Write time stamp to ROOT file</span>
<a name="line-175"></a><span class="c1">//! \param[in] it Iteration number</span>
<a name="line-176"></a><span class="c1">//! \param[in] time Time</span>
<a name="line-177"></a><span class="c1">// *****************************************************************************</span>
<a name="line-178"></a><span class="p">{</span>
<a name="line-179"></a>  
<a name="line-180"></a>  <span class="c1">// create a friend tree to the main tree</span>
<a name="line-181"></a>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">tree</span> <span class="o">=</span> <span class="s">&quot;tf_var_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
<a name="line-182"></a>  <span class="n">m_friendTree</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TTree</span> <span class="p">(</span> <span class="n">tree</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="s">&quot;friend trees&quot;</span> <span class="p">);</span>
<a name="line-183"></a>
<a name="line-184"></a>  <span class="c1">// create a branch for the time step</span>
<a name="line-185"></a>  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">;</span>
<a name="line-186"></a>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">branch_time</span> <span class="o">=</span> <span class="s">&quot;time_branch_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
<a name="line-187"></a>  <span class="n">m_friendTree</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="n">branch_time</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">elapsed_time</span><span class="p">,</span> <span class="s">&quot;elapsed_time/D&quot;</span> <span class="p">);</span>
<a name="line-188"></a>
<a name="line-189"></a>  <span class="n">m_friendTree</span><span class="o">-&gt;</span><span class="n">Fill</span><span class="p">();</span>
<a name="line-190"></a>  <span class="n">m_tree_connect</span><span class="o">-&gt;</span><span class="n">AddFriend</span><span class="p">(</span> <span class="n">tree</span><span class="p">.</span><span class="n">c_str</span><span class="p">()</span> <span class="p">);</span>
<a name="line-191"></a>
<a name="line-192"></a><span class="p">}</span>
<a name="line-193"></a>
<a name="line-194"></a><span class="kt">void</span>
<a name="line-195"></a><span class="n">RootMeshWriter</span><span class="o">::</span><span class="n">writeNodeScalar</span><span class="p">(</span> <span class="kt">uint64_t</span> <span class="n">it</span><span class="p">,</span>
<a name="line-196"></a>                                     <span class="kt">int</span> <span class="n">varid</span><span class="p">,</span>
<a name="line-197"></a>                                     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;&amp;</span> <span class="n">var</span> <span class="p">)</span> <span class="k">const</span>
<a name="line-198"></a><span class="c1">// *****************************************************************************</span>
<a name="line-199"></a><span class="c1">//  Write node scalar field to ROOT file</span>
<a name="line-200"></a><span class="c1">//! \param[in] it Iteration number</span>
<a name="line-201"></a><span class="c1">//! \param[in] varid Variable id</span>
<a name="line-202"></a><span class="c1">//! \param[in] var Vector of variable to output</span>
<a name="line-203"></a><span class="c1">// *****************************************************************************</span>
<a name="line-204"></a><span class="p">{</span>
<a name="line-205"></a>
<a name="line-206"></a>  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="n">vec_copy</span><span class="p">;</span>
<a name="line-207"></a>
<a name="line-208"></a>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">branch_field</span> <span class="o">=</span> <span class="s">&quot;branch_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;_field_&quot;</span> <span class="o">+</span> 
<a name="line-209"></a>			      <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">varid</span><span class="p">);</span>
<a name="line-210"></a>  <span class="c1">//create a Branch</span>
<a name="line-211"></a>  <span class="n">m_friendTree</span><span class="o">-&gt;</span><span class="n">Branch</span><span class="p">(</span> <span class="n">branch_field</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">vec_copy</span> <span class="p">);</span>
<a name="line-212"></a>  
<a name="line-213"></a>  <span class="c1">//copy the values</span>
<a name="line-214"></a>  <span class="k">for</span><span class="p">(</span> <span class="k">auto</span> <span class="n">itr</span> <span class="o">=</span> <span class="n">var</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">itr</span> <span class="o">!=</span> <span class="n">var</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">itr</span><span class="o">++</span> <span class="p">)</span>
<a name="line-215"></a>    <span class="n">vec_copy</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="o">*</span><span class="n">itr</span> <span class="p">);</span>
<a name="line-216"></a>
<a name="line-217"></a>  <span class="n">m_friendTree</span><span class="o">-&gt;</span><span class="n">Fill</span><span class="p">();</span>
<a name="line-218"></a>  <span class="n">m_friendTree</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">();</span>
<a name="line-219"></a>
<a name="line-220"></a><span class="p">}</span>
<a name="line-221"></a>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
