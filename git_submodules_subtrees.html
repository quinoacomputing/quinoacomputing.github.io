<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Modules | Quinoa docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="quinoa.m-dark-noindent+doxygen.compiled.css" />
  <link rel="icon" href="quinoa_sum.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Quinoa <span class="m-thin">docs</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="why.html">Why</a></li>
            <li>
              <a href="build.html">Build</a>
              <ol>
                <li><a href="git_submodules_subtrees.html" id="m-navbar-current">Modules</a></li>
                <li><a href="licenses.html">Libraries</a></li>
                <li><a href="build_system.html">Internals</a></li>
              </ol>
            </li>
            <li>
              <a href="https://quinoacomputing.github.io/index.html#mainpage_tools">Tools</a>
              <ol>
                <li><a href="inciter_main.html">Inciter</a></li>
                <li><a href="unittest_main.html">UnitTest</a></li>
                <li><a href="meshconv_main.html">MeshConv</a></li>
              </ol>
            </li>
            <li><a href="namespaces.html">Namespaces</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="7">
            <li>
              <a href="resources.html">Resources</a>
              <ol>
                <li><a href="https://github.com/quinoacomputing/quinoa">GitHub</a></li>
                <li><a href="papers.html">Publications</a></li>
                <li><a href="https://github.com/quinoacomputing/quinoa/blob/master/LICENSE">License</a></li>
                <li><a href="roadmap.html">Roadmap</a></li>
                <li><a href="contributing.html">Contributing</a></li>
                <li><a href="coverage.html">Coverage</a></li>
                <li><a href="https://github.com/quinoacomputing/quinoa/releases">Tarballs</a></li>
                <li><a href="https://bestpractices.coreinfrastructure.org/projects/2120">Practices</a></li>
              </ol>
            </li>
            <li class="m-show-m"><a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Modules
        </h1>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#tpl_vs_tool">TPLs and external tools</a></li>
            <li>
              <a href="#git_subtree">Git subtree for sharing cmake code</a>
              <ul>
                <li><a href="#git_subtree_add">Set up the cmake subtree</a></li>
                <li><a href="#git_subtree_pull">Pull changes from the cmake repository</a></li>
                <li><a href="#git_subtree_push">Push changes to the cmake repository</a></li>
                <li><a href="#subtree_info">Useful links on git subtree</a></li>

              </ul>
            </li>
            <li><a href="#git_submodule">Git submodule for incorporating TPLs</a></li>
            <li><a href="#submodule_new">Add a new TPL as a new submodule</a></li>
          </ul>
        </div>
<p>This page discusses how Quinoa&#x27;s code repositories are organized into git submodules and subtrees. It also gives an example of how to add a new third-party library (TPL) as a new submodule.</p><p>Quinoa uses git <em>submodules</em> as well as git <em>subtrees</em> to pull in third-party libraries (TPLs) and auxiliary tools. This allows easy update to a TPL&#x27;s (or tool&#x27;s) new or custom version, record all TPLs&#x27; and tools&#x27; histories (including branches and tags), and also allows contributing fixes upstream, all within git. There are some differences between git&#x27;s submodule and subtree functionality each with its own pros and cons. This page explains how to use git submodules and subtrees in Quinoa.</p><section id="tpl_vs_tool"><h2><a href="#tpl_vs_tool">TPLs and external tools</a></h2><p>An important distinction between TPLs and tools is that TPLs are libraries whose source we directly use, e.g., via include files and/or (static and dynamic) linking, while from a tool we do not include source code nor link its object files, only build it and use it as a separate (external) executable. To learn more about TPLs and tools, check out the page on <a href="licenses.html" class="m-dox">Libraries</a>.</p></section><section id="git_subtree"><h2><a href="#git_subtree">Git subtree for sharing cmake code</a></h2><p>Currently there is a single git subtree in quinoa and is used to reuse/share cmake code between two repositories</p><ul><li><a href="https://github.com/quinoacomputing/quinoa">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />quinoa</a> under directory <a href="https://github.com/quinoacomputing/quinoa/tree/master/cmake">cmake/<wbr /></a>, and</li><li><a href="https://github.com/quinoacomputing/quinoa-tpl">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />quinoa-tpl</a> under directory <a href="https://github.com/quinoacomputing/quinoa-tpl/tree/master/cmake">cmake/<wbr /></a>, and</li></ul><p>Both of the above git repositories are setup to pull in the cmake code from the <a href="https://github.com/quinoacomputing/cmake-modules">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />cmake-modules</a> repository, in quinoa as a subtree, in the TPL repository as a submodule.</p><section id="git_subtree_add"><h3><a href="#git_subtree_add">Set up the cmake subtree</a></h3><p>This has to be done only the first time you intend to make changes to the cmake directory in <code>quinoa\</code>. To set up the git subtree from the cmake repository (branch <em>master</em>), first remove the <code>cmake</code> directory under <code>quinoa\</code> and commit the change. Then do</p><pre class="m-code">git remote add -f cmake https://github.com/quinoacomputing/cmake-modules.git
git subtree add --prefix<span class="o">=</span>cmake --squash https://github.com/quinoacomputing/cmake-modules.git master</pre><p>This sets up the cmake subtree in your local Quinoa directory.</p></section><section id="git_subtree_pull"><h3><a href="#git_subtree_pull">Pull changes from the cmake repository</a></h3><p>To pull in the latest updates from the cmake repository (from its branch <em>master</em>) into the quinoa repository, do</p><pre class="m-code">git fetch cmake
git subtree pull --prefix<span class="o">=</span>cmake cmake master --squash</pre></section><section id="git_subtree_push"><h3><a href="#git_subtree_push">Push changes to the cmake repository</a></h3><p>If you have committed changes in the quinoa repository under the cmake subtree directory <code>cmake</code>, here is how you push the changes upstream to the cmake git repository.</p><ul><li>Verify the changes you are about to push by examining the diff output:</li></ul><pre class="m-code">git diff cmake/master master:cmake</pre><ul><li>If you are happy with the diff, push the changes upstream (to the <em>master</em> branch of the cmake repository):</li></ul><pre class="m-code">git subtree push --prefix<span class="o">=</span>cmake cmake master</pre></section><section id="subtree_info"><h3><a href="#subtree_info">Useful links on git subtree</a></h3><ul><li><a href="https://hpc.uni.lu/blog/2014/understanding-git-subtree">https:/<wbr />/<wbr />hpc.uni.lu/<wbr />blog/<wbr />2014/<wbr />understanding-git-subtree</a></li><li><a href="http://getlevelten.com/blog/tom-mccracken/smarter-drupal-projects-projects-management-git-subtree">http:/<wbr />/<wbr />getlevelten.com/<wbr />blog/<wbr />tom-mccracken/<wbr />smarter-drupal-projects-projects-management-git-subtree</a></li><li><a href="https://github.com/git/git/blob/master/contrib/subtree/git-subtree.txt">https:/<wbr />/<wbr />github.com/<wbr />git/<wbr />git/<wbr />blob/<wbr />master/<wbr />contrib/<wbr />subtree/<wbr />git-subtree.txt</a></li><li><a href="http://blogs.atlassian.com/2013/05/alternatives-to-git-submodule-git-subtree">http:/<wbr />/<wbr />blogs.atlassian.com/<wbr />2013/<wbr />05/<wbr />alternatives-to-git-submodule-git-subtree</a></li><li><a href="http://www.codeproject.com/Articles/562949/ManagingplusNestedplusLibrariesplusUsingplustheplu">http:/<wbr />/<wbr />www.codeproject.com/<wbr />Articles/<wbr />562949/<wbr />ManagingplusNestedplusLibrariesplusUsingplustheplu</a></li></ul></section></section><section id="git_submodule"><h2><a href="#git_submodule">Git submodule for incorporating TPLs</a></h2><p>To ease and automate building the <a href="licenses.html" class="m-dox">third-party libraries</a> that are not always available on a system, we maintain a <a href="https://github.com/quinoacomputing/quinoa-tpl">git repository</a> that consists of a list of git submodules pointing to the libraries. Check the <a href="index.html#mainpage_build" class="m-dox">Build section of the main page</a> for a list of libraries that <em>may</em> be installed by your operating system&#x27;s package manager, which then can accelerate and ease installing the TPLs.</p><p>When you do a clone of quinoa</p><pre class="m-code">git clone --recurse-submodules https://github.com/quinoacomputing/quinoa.git</pre><p>all submodules are cloned and initialized. This is probably the simplest way to clone the code with all dependencies, however it is not necessarily the quickest to work with, since git operations will take longer when submodules are present and most developers will only need the submodules once (to build and install the TPLs).</p><p>Another way of cloning (and working with) quinoa is to <em>not</em> clone the submodules, but work with the git repositories for quinoa, cmake, and the TPLs separately. Since the cmake code and the TPLs are much less frequently updated compared to the code in quinoa, the TPLs can be cloned, built, and forgotten about. This approach, however, will require the specification of the <code>-DTPL_DIR=&lt;path-to-installed-tpls&gt;</code> command line argument to quinoa&#x27;s cmake command. This way, the quinoa repository, which still has the cmake directory as a git subtree, is kept minimal, and thus git operations, e.g., switching branches, stashing, are quicker. This can be especially useful on large HPC machines where the large parallel file systems are shared among many users who may be doing heavy I/O. Another option is to <em>deinitialize</em> the submodules once not needed if they were recursively cloned and initialized.</p></section><section id="submodule_new"><h2><a href="#submodule_new">Add a new TPL as a new submodule</a></h2><p>This section walks through on adding a new TPL as a git submodule. We add a new library <code>Sol2</code>, which is header-only (no build required, only a copy of the header files) and depends on Lua.</p><p>First, we tell the <code>quinoa-tpl</code> repository about the the source repository of <code>Sol2</code> as a new git submodule:</p><pre class="m-code">git clone https://github.com/quinoacomputing/quinoa-tpl.git
<span class="nb">cd</span> quinoa-tpl
git submodule add https://github.com/ThePhD/sol2.git src/sol2
<span class="nb">cd</span> src/sol2 <span class="o">&amp;&amp;</span> git checkout v3.2.0 <span class="o">&amp;&amp;</span> <span class="nb">cd</span> -
git add src/sol2</pre><p>Then we extend <code>quinoa-tpl/CMakeLists.txt</code>. The best is to find a library similar to the one being added and add the relevant sections. Since <code>Sol2</code> is a header-only library, we just find everything <code>brigand</code>-related (<code>brigand</code> is also a header-only library) and end up with the following diff:</p><pre class="m-code">$ git diff CMakeLists.txt
<span class="gh">diff --git a/CMakeLists.txt b/CMakeLists.txt</span>
<span class="gh">index 32e715d..595bed9 100644</span>
<span class="gd">--- a/CMakeLists.txt</span>
<span class="gi">+++ b/CMakeLists.txt</span>
<span class="gu">@@ -92,6 +92,7 @@ set(ENABLE_BACKWARDCPP ON CACHE BOOL &quot;Enable BackwardCpp&quot;)</span>
 set(ENABLE_HIGHWAYHASH ON CACHE BOOL &quot;Enable HighwayHash&quot;)
 set(ENABLE_OMEGAH OFF CACHE BOOL &quot;Enable Omega_H&quot;)
 set(ENABLE_BRIGAND ON CACHE BOOL &quot;Enable Brigand&quot;)
<span class="gi">+set(ENABLE_SOL2 ON CACHE BOOL &quot;Enable Sol2&quot;)</span>
 set(ENABLE_DOXYGEN ON CACHE BOOL &quot;Enable Doxygen&quot;)
 set(ENABLE_MCSS ON CACHE BOOL &quot;Enable m.css&quot;)

<span class="gu">@@ -124,6 +125,7 @@ if (UNITTEST_ONLY OR INCITER_ONLY OR RNGTEST_ONLY OR MESHCONV_ONLY OR</span>
   set(ENABLE_HIGHWAYHASH OFF)
   set(ENABLE_OMEGAH OFF)
   set(ENABLE_BRIGAND OFF)
<span class="gi">+  set(ENABLE_SOL2 OFF)</span>
   set(ENABLE_DOXYGEN OFF)
   set(ENABLE_MCSS OFF)
   set(REQUESTED_EXECUTABLES)
<span class="gu">@@ -157,6 +159,7 @@ if (UNITTEST_ONLY OR INCITER_ONLY OR RNGTEST_ONLY OR MESHCONV_ONLY OR</span>
     set(ENABLE_HDF5 ON)
     set(ENABLE_HIGHWAYHASH ON)
     set(ENABLE_BRIGAND ON)
<span class="gi">+    set(ENABLE_SOL2 ON)</span>
     set(ENABLE_PEGTL ON)
     set(ENABLE_LAPACK ON)
     set(ENABLE_BOOST ON)
<span class="gu">@@ -724,6 +727,17 @@ if (ENABLE_BRIGAND)</span>
   endif()
 endif()

<span class="gi">+# Sol2</span>
<span class="gi">+if (ENABLE_SOL2)</span>
<span class="gi">+  find_package(Lua)</span>
<span class="gi">+  find_package(Sol2)</span>
<span class="gi">+  if(SOL2_FOUND)</span>
<span class="gi">+    set(sol2 &quot;&quot;)</span>
<span class="gi">+  else()</span>
<span class="gi">+    set(sol2 &quot;sol2&quot;)</span>
<span class="gi">+  endif()</span>
<span class="gi">+endif()</span>
<span class="gi">+</span>
 # Doxygen
 if (ENABLE_DOXYGEN)
   find_package(Doxygen 1.8.15)
<span class="gu">@@ -758,7 +772,7 @@ get_compiler_flags()</span>
 set(tpls2build ${charm} ${hdf5} ${netcdf} ${boost} ${pstreams}
 ${pugixml} ${pegtl} ${random123} ${rngsse2} ${lapack} ${aec} ${h5part}
 ${testu01} ${trilinos} ${tut} ${numdiff} ${root} ${backwardcpp} ${highwayhash}
<span class="gd">-${omega_h} ${brigand} ${doxygen} ${mcss})</span>
<span class="gi">+${omega_h} ${brigand} ${sol2} ${doxygen} ${mcss})</span>

 list(LENGTH tpls2build ntpl)
 list(SORT tpls2build)
<span class="gu">@@ -1333,6 +1347,23 @@ if (brigand)</span>
   )
 endif()

<span class="gi">+#### Sol2 ######################################################################</span>
<span class="gi">+# https://github.com/ThePhD/sol2</span>
<span class="gi">+# Header only, only if not found</span>
<span class="gi">+if (sol2)</span>
<span class="gi">+  ExternalProject_Add(</span>
<span class="gi">+    sol2</span>
<span class="gi">+    PREFIX sol2</span>
<span class="gi">+    # Header-only, copy include dir over</span>
<span class="gi">+    CONFIGURE_COMMAND ${CMAKE_COMMAND} -E copy_directory</span>
<span class="gi">+                      ${PROJECT_SOURCE_DIR}/src/sol2/include/sol</span>
<span class="gi">+                      ${CMAKE_INSTALL_PREFIX}/include/sol</span>
<span class="gi">+    BUILD_COMMAND &quot;&quot;</span>
<span class="gi">+    INSTALL_COMMAND &quot;&quot;</span>
<span class="gi">+    DOWNLOAD_COMMAND &quot;&quot;</span>
<span class="gi">+  )</span>
<span class="gi">+endif()</span>
<span class="gi">+</span>
 #### Doxygen, documentation generation #########################################
 # https://doxygen.org
 if (doxygen)</pre><p>We also add cmake code to find Sol2, as a new file <code>cmake/FindSol2.cmake</code>, since we do not expect that to be packaged by the OS.</p><pre class="m-code"><span class="c">################################################################################</span>
<span class="c">#</span>
<span class="c"># \file      FindSol2.cmake</span>
<span class="c"># \copyright 2012-2015 J. Bakosi,</span>
<span class="c">#            2016-2018 Los Alamos National Security, LLC.,</span>
<span class="c">#            2019-2021 Triad National Security, LLC.</span>
<span class="c">#            All rights reserved. See the LICENSE file for details.</span>
<span class="c"># \brief     Find the Sol2 Lua C++ binding library</span>
<span class="c">#</span>
<span class="c">################################################################################</span>

<span class="c"># Sol2: https://github.com/ThePhD/sol2</span>
<span class="c">#</span>
<span class="c">#  SOL2_FOUND - System has Sol2</span>
<span class="c">#  SOL2_INCLUDE_DIRS - The Sol2 include directory</span>
<span class="c">#</span>
<span class="c">#  Set the SOL2_ROOT cmake variable or shell environment variable before</span>
<span class="c">#  calling find_package to a path to add an additional search path, e.g.,</span>
<span class="c">#</span>
<span class="c">#  Usage:</span>
<span class="c">#</span>
<span class="c">#  set(SOL2_ROOT &quot;/path/to/custom/brigand&quot;) # prefer over system</span>
<span class="c">#  find_package(Sol2)</span>
<span class="c">#  include_directories(${SOL2_INCLUDE_DIRS})</span>

<span class="c"># If already in cache, be silent</span>
<span class="nb">if</span><span class="p">(</span><span class="s">SOL2_INCLUDE_DIRS</span><span class="p">)</span>
  <span class="nb">set</span> <span class="p">(</span><span class="s">SOL2_FIND_QUIETLY</span> <span class="s">TRUE</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">find_path</span><span class="p">(</span><span class="s">SOL2_INCLUDE_DIR</span> <span class="s">NAMES</span> <span class="s">sol.hpp</span>
                           <span class="s">HINTS</span> <span class="o">${</span><span class="nv">SOL2_ROOT</span><span class="o">}</span><span class="s">/include</span>
                                 <span class="o">$ENV{</span><span class="nv">SOL2_ROOT</span><span class="o">}</span><span class="s">/include</span>
                           <span class="s">PATH_SUFFIXES</span> <span class="s">sol</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">SOL2_INCLUDE_DIRS</span> <span class="o">${</span><span class="nv">SOL2_INCLUDE_DIR</span><span class="o">}</span><span class="p">)</span>

<span class="c"># Handle the QUIETLY and REQUIRED arguments and set SOL2_FOUND to TRUE if</span>
<span class="c"># all listed variables are TRUE.</span>
<span class="nb">INCLUDE</span><span class="p">(</span><span class="s">FindPackageHandleStandardArgs</span><span class="p">)</span>
<span class="nb">FIND_PACKAGE_HANDLE_STANDARD_ARGS</span><span class="p">(</span><span class="s">Sol2</span> <span class="s">REQUIRED_VARS</span> <span class="s">SOL2_INCLUDE_DIRS</span><span class="p">)</span>

<span class="nb">MARK_AS_ADVANCED</span><span class="p">(</span><span class="s">SOL2_INCLUDE_DIRS</span><span class="p">)</span></pre><aside class="m-note m-info"><h4>Note</h4><p>We assume that <a href="https://www.lua.org">Lua</a>, required by Sol2, will be found on the system. On debian/ubuntu Lua can be installed by <code>apt-get install liblua5.3-dev</code>.</p></aside><p>We can now test if the TPL build works:</p><pre class="m-code"><span class="nb">cd</span> quinoa-tpl <span class="o">&amp;&amp;</span> mdkir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
cmake ..</pre><p>Example cmake screen output:</p><pre class="m-code">...
-- Found Lua: /usr/lib/x86_64-linux-gnu/liblua5.3.so<span class="p">;</span>/usr/lib/x86_64-linux-gnu/libm.so <span class="o">(</span>found version <span class="s2">&quot;5.3.3&quot;</span><span class="o">)</span>
-- Could NOT find Sol2 <span class="o">(</span>missing: SOL2_INCLUDE_DIRS<span class="o">)</span>
...</pre><p>As expected, Lua is there on the system, but we need to supply Sol2. Now we build sol2, and see if it is found:</p><pre class="m-code">make sol2
cmake .</pre><p>Example cmake screen output:</p><pre class="m-code">...
-- Found Lua: /usr/lib/x86_64-linux-gnu/liblua5.3.so<span class="p">;</span>/usr/lib/x86_64-linux-gnu/libm.so <span class="o">(</span>found version <span class="s2">&quot;5.3.3&quot;</span><span class="o">)</span>
-- Found Sol2: <span class="o">[</span>...<span class="o">]</span>/quinoa-tpl/install/clang-x86_64/include/sol
...</pre><p>Since this works fine, we commit the changes to the <code>quinoa-tpl</code> repository:</p><pre class="m-code">git add CMakeLists.txt
git status
git commit -m<span class="s2">&quot;Add lua and sol2&quot;</span></pre><p>Example <code>git status</code> output from above:</p><pre class="m-code">On branch master
Your branch is up to date with <span class="s1">&#39;origin/master&#39;</span>.

Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

        modified:   .gitmodules
        modified:   CMakeLists.txt
        new file:   src/sol2

Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes in working directory<span class="o">)</span>
  <span class="o">(</span>commit or discard the untracked or modified content in submodules<span class="o">)</span>

        modified:   cmake <span class="o">(</span>untracked content<span class="o">)</span>
...</pre><aside class="m-note m-info"><h4>Note</h4><p>We do <em>not</em> commit the contents of the <code>cmake/</code> directory to the <code>quinoa-tpl</code> repository. Changes in that go into the <a href="https://github.com/quinoacomputing/cmake-modules">cmake-modules</a> repository.</p></aside><p>We also update <code>cmake/TPLs.cmake</code> in the cmake-modules repository to include and run cmake code that finds Lua and Sol2 when quinoa is configured.</p><p>First, clone <code>cmake-modules</code>:</p><pre class="m-code">git clone https://github.com/quinoacomputing/cmake-modules.git
<span class="nb">cd</span> cmake-modules</pre><p>Next, augment <code>TPLs.cmake</code> in the cmake-module repository, which runs when quinoa is configured:</p><pre class="m-code">$ git diff TPLs.cmake
<span class="gh">diff --git a/cmake/TPLs.cmake b/cmake/TPLs.cmake</span>
<span class="gh">index a7ca35a93..f4064ea2c 100644</span>
<span class="gd">--- a/cmake/TPLs.cmake</span>
<span class="gi">+++ b/cmake/TPLs.cmake</span>
<span class="gu">@@ -156,6 +156,11 @@ find_package(HighwayHash)</span>
 set(BRIGAND_ROOT ${TPL_DIR}) # prefer ours
 find_package(Brigand)

<span class="gi">+#### Configure Sol2</span>
<span class="gi">+set(SOL2_ROOT ${TPL_DIR}) # prefer ours</span>
<span class="gi">+find_package(Lua)</span>
<span class="gi">+find_package(Sol2)</span>
<span class="gi">+</span>
 message(STATUS &quot;------------------------------------------&quot;)

 # Function to print a list of missing library names
<span class="gu">@@ -197,11 +202,12 @@ endif()</span>

 if (CHARM_FOUND AND SEACASExodus_FOUND AND EXODIFF_FOUND AND
     Zoltan2_FOUND AND HDF5_FOUND AND BRIGAND_FOUND AND PEGTL_FOUND AND
<span class="gd">-    LAPACKE_FOUND AND Boost_FOUND AND HIGHWAYHASH_FOUND)</span>
<span class="gi">+    LAPACKE_FOUND AND Boost_FOUND AND HIGHWAYHASH_FOUND AND</span>
<span class="gi">+    LUA_FOUND AND SOL2_FOUND)</span>
   set(ENABLE_INCITER &quot;true&quot;)
   set(INCITER_EXECUTABLE inciter)
 else()
<span class="gd">-  PrintMissing(inciter &quot;CHARM_FOUND;SEACASExodus_FOUND;EXODIFF_FOUND;Zoltan2_FOUND;HDF5_FOUND;BRIGAND_FOUND;PEGTL_FOUND;LAPACKE_FOUND;Boost_FOUND&quot;)</span>
<span class="gi">+  PrintMissing(inciter &quot;CHARM_FOUND;SEACASExodus_FOUND;EXODIFF_FOUND;Zoltan2_FOUND;HDF5_FOUND;BRIGAND_FOUND;PEGTL_FOUND;LAPACKE_FOUND;Boost_FOUND;LUA_FOUND;SOL2_FOUND&quot;)</span>
 endif()

 if (CHARM_FOUND AND TESTU01_FOUND AND BRIGAND_FOUND AND PEGTL_FOUND AND</pre><p>Now we commit the changes to <code>cmake-modules</code>:</p><pre class="m-code"><span class="nb">cd</span> cmake-modules
mv quinoa-tpl/cmake/FindSol2.cmake .
git add FindSol2.cmake TPLs.cmake
git commit -m<span class="s2">&quot;Add cmake code so quinoa finds Lua and Sol2&quot;</span>
git push</pre><aside class="m-note m-info"><h4>Note</h4><p>Since we <em>moved</em> <code>FindSol2.cmake</code> from quinoa-tpl/cmake, we pull it in from the cmake repository:</p></aside><pre class="m-code"><span class="nb">cd</span> quinoa-tpl/cmake
git pull</pre><p>Next we commit the change in the TPL repo to reflect the updated <code>cmake</code> submodule:</p><pre class="m-code"><span class="nb">cd</span> quinoa-tpl
git add cmake
git commit -m<span class="s2">&quot;Pull in latest cmake&quot;</span>
git push</pre><p>Finally, we pull the changes from both the <code>cmake</code> subtree (cmake-modules repository) and the TPLs (quinoa-tpl) into the <code>quinoa</code> repository.</p><pre class="m-code">git clone https://github.com/quinoacomputing/quinoa.git
<span class="nb">cd</span> quinoa
git submodule init <span class="o">&amp;&amp;</span> git submodule update --recursive <span class="o">&amp;&amp;</span> <span class="nb">cd</span> external <span class="o">&amp;&amp;</span> git submodule init <span class="o">&amp;&amp;</span> git submodule update --recursive <span class="o">&amp;&amp;</span> <span class="nb">cd</span> .. <span class="o">&amp;&amp;</span> git submodule status --recursive
<span class="nb">cd</span> external <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> <span class="nb">cd</span> -
<span class="nb">cd</span> cmake <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> <span class="nb">cd</span> -
git submodule update --init external/src/sol2
git commit -am<span class="s2">&quot;Pull in latest external&quot;</span>
git fetch cmake
git subtree pull --prefix<span class="o">=</span>cmake cmake master --squash</pre><aside class="m-note m-info"><h4>Note</h4><p>The above instructions assume a <a href="build.html#build_nonrecursive" class="m-dox">non-recursive</a> clone of the quinoa repository.</p></aside></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-dox-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-dox-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-dox-search-content">
          <input type="search" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" />
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://google.com/search?q=site:quinoacomputing.github.io+">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            Search for symbols, directories, files, pages or modules. You can omit any
            prefix from the symbol or file path; adding a <code>:</code> or <code>/</code>
            suffix lists all members of given symbol or directory. Navigate through the
            list using <span class="m-label m-dim">&darr;</span> and
            <span class="m-label m-dim">&uarr;</span>, press
            <span class="m-label m-dim">Enter</span> to go.
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://google.com/search?q=site:quinoacomputing.github.io+{query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Quinoa docs, part of the <a href="http://quinoacomputing.github.io/">Quinoa project</a>. Copyright © J. Bakosi 2012&ndash;2015, Los Alamos National Security, LLC, 2016&ndash;2018, <a href="https://www.triadns.org/">Triad National Security, LLC,</a> 2019-2021. Generated on Wednesday, Aug 16, 2023 based on <a href="https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND">-128-NOTFOUND</a> by <a href="http://doxygen.org/">Doxygen</a> and <a href="http://mcss.mosra.cz/">m.css</a>. Contact us via <a href="https://github.com/quinoacomputing/quinoa/issues">GitHub</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>