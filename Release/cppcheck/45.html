
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href=https://github.com/quinoacomputing/quinoa/commit/dfc2d0e79>Quinoa_v0.3-984-gdfc2d0e79</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [<a href=https://github.com/quinoacomputing/quinoa/commit/dfc2d0e79>Quinoa_v0.3-984-gdfc2d0e79</a>]: /home/apandare/TeamCity/BuildAgent2/work/65043de74745064a/src/Inciter/DG.hpp</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> DG.hpp</p>
<a href="45.html#line-319"> constParameter 319</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/Inciter/DG.hpp</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015 J. Bakosi,</span>
<a name="line-5"></a><span class="cm">             2016-2018 Los Alamos National Security, LLC.,</span>
<a name="line-6"></a><span class="cm">             2019-2021 Triad National Security, LLC.</span>
<a name="line-7"></a><span class="cm">             All rights reserved. See the LICENSE file for details.</span>
<a name="line-8"></a><span class="cm">  \brief     DG advances a system of PDEs with the discontinuous Galerkin scheme</span>
<a name="line-9"></a><span class="cm">  \details   DG advances a system of partial differential equations (PDEs) using</span>
<a name="line-10"></a><span class="cm">    discontinuous Galerkin (DG) finite element (FE) spatial discretization (on</span>
<a name="line-11"></a><span class="cm">    tetrahedron elements) combined with Runge-Kutta (RK) time stepping.</span>
<a name="line-12"></a>
<a name="line-13"></a><span class="cm">    There are a potentially large number of DG Charm++ chares created by</span>
<a name="line-14"></a><span class="cm">    Transporter. Each DG gets a chunk of the full load (part of the mesh)</span>
<a name="line-15"></a><span class="cm">    and does the same: initializes and advances a number of PDE systems in time.</span>
<a name="line-16"></a>
<a name="line-17"></a><span class="cm">    The implementation uses the Charm++ runtime system and is fully</span>
<a name="line-18"></a><span class="cm">    asynchronous, overlapping computation and communication. The algorithm</span>
<a name="line-19"></a><span class="cm">    utilizes the structured dagger (SDAG) Charm++ functionality. The high-level</span>
<a name="line-20"></a><span class="cm">    overview of the algorithm structure and how it interfaces with Charm++ is</span>
<a name="line-21"></a><span class="cm">    discussed in the Charm++ interface file src/Inciter/dg.ci.</span>
<a name="line-22"></a><span class="cm">*/</span>
<a name="line-23"></a><span class="c1">// *****************************************************************************</span>
<a name="line-24"></a><span class="cp">#ifndef DG_h</span>
<a name="line-25"></a><span class="cp">#define DG_h</span>
<a name="line-26"></a>
<a name="line-27"></a><span class="cp">#include</span> <span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<a name="line-28"></a><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp"></span>
<a name="line-29"></a><span class="cp">#include</span> <span class="cpf">&lt;unordered_set&gt;</span><span class="cp"></span>
<a name="line-30"></a><span class="cp">#include</span> <span class="cpf">&lt;unordered_map&gt;</span><span class="cp"></span>
<a name="line-31"></a>
<a name="line-32"></a><span class="cp">#include</span> <span class="cpf">&quot;DerivedData.hpp&quot;</span><span class="cp"></span>
<a name="line-33"></a><span class="cp">#include</span> <span class="cpf">&quot;FaceData.hpp&quot;</span><span class="cp"></span>
<a name="line-34"></a><span class="cp">#include</span> <span class="cpf">&quot;ElemDiagnostics.hpp&quot;</span><span class="cp"></span>
<a name="line-35"></a>
<a name="line-36"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/dg.decl.h&quot;</span><span class="cp"></span>
<a name="line-37"></a>
<a name="line-38"></a><span class="k">namespace</span> <span class="n">inciter</span> <span class="p">{</span>
<a name="line-39"></a>
<a name="line-40"></a><span class="c1">//! DG Charm++ chare array used to advance PDEs in time with DG+RK</span>
<a name="line-41"></a><span class="k">class</span> <span class="nc">DG</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CBase_DG</span> <span class="p">{</span>
<a name="line-42"></a>
<a name="line-43"></a>  <span class="k">public</span><span class="o">:</span>
<a name="line-44"></a>    <span class="cp">#if defined(__clang__)</span>
<a name="line-45"></a>      <span class="cp">#pragma clang diagnostic push</span>
<a name="line-46"></a>      <span class="cp">#pragma clang diagnostic ignored &quot;-Wunused-parameter&quot;</span>
<a name="line-47"></a>      <span class="cp">#pragma clang diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span>
<a name="line-48"></a>    <span class="cp">#elif defined(STRICT_GNUC)</span>
<a name="line-49"></a>      <span class="cp">#pragma GCC diagnostic push</span>
<a name="line-50"></a>      <span class="cp">#pragma GCC diagnostic ignored &quot;-Wunused-parameter&quot;</span>
<a name="line-51"></a>      <span class="cp">#pragma GCC diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span>
<a name="line-52"></a>    <span class="cp">#elif defined(__INTEL_COMPILER)</span>
<a name="line-53"></a>      <span class="cp">#pragma warning( push )</span>
<a name="line-54"></a>      <span class="cp">#pragma warning( disable: 1478 )</span>
<a name="line-55"></a>    <span class="cp">#endif</span>
<a name="line-56"></a>    <span class="c1">// Include Charm++ SDAG code. See http://charm.cs.illinois.edu/manuals/html/</span>
<a name="line-57"></a>    <span class="c1">// charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</span>
<a name="line-58"></a>    <span class="n">DG_SDAG_CODE</span>
<a name="line-59"></a>    <span class="cp">#if defined(__clang__)</span>
<a name="line-60"></a>      <span class="cp">#pragma clang diagnostic pop</span>
<a name="line-61"></a>    <span class="cp">#elif defined(STRICT_GNUC)</span>
<a name="line-62"></a>      <span class="cp">#pragma GCC diagnostic pop</span>
<a name="line-63"></a>    <span class="cp">#elif defined(__INTEL_COMPILER)</span>
<a name="line-64"></a>      <span class="cp">#pragma warning( pop )</span>
<a name="line-65"></a>    <span class="cp">#endif</span>
<a name="line-66"></a>
<a name="line-67"></a>    <span class="c1">//! Constructor</span>
<a name="line-68"></a>    <span class="k">explicit</span> <span class="n">DG</span><span class="p">(</span> <span class="k">const</span> <span class="n">CProxy_Discretization</span><span class="o">&amp;</span> <span class="n">disc</span><span class="p">,</span>
<a name="line-69"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">bface</span><span class="p">,</span>
<a name="line-70"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="cm">/* bnode */</span><span class="p">,</span>
<a name="line-71"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">triinpoel</span> <span class="p">);</span>
<a name="line-72"></a>
<a name="line-73"></a>    <span class="cp">#if defined(__clang__)</span>
<a name="line-74"></a>      <span class="cp">#pragma clang diagnostic push</span>
<a name="line-75"></a>      <span class="cp">#pragma clang diagnostic ignored &quot;-Wundefined-func-template&quot;</span>
<a name="line-76"></a>    <span class="cp">#endif</span>
<a name="line-77"></a>    <span class="c1">//! Migrate constructor</span>
<a name="line-78"></a>    <span class="c1">// cppcheck-suppress uninitMemberVar</span>
<a name="line-79"></a>    <span class="k">explicit</span> <span class="nf">DG</span><span class="p">(</span> <span class="n">CkMigrateMessage</span><span class="o">*</span> <span class="n">msg</span> <span class="p">)</span> <span class="o">:</span> <span class="n">CBase_DG</span><span class="p">(</span> <span class="n">msg</span> <span class="p">)</span> <span class="p">{}</span>
<a name="line-80"></a>    <span class="cp">#if defined(__clang__)</span>
<a name="line-81"></a>      <span class="cp">#pragma clang diagnostic pop</span>
<a name="line-82"></a>    <span class="cp">#endif</span>
<a name="line-83"></a>
<a name="line-84"></a>    <span class="c1">//! Return from migration</span>
<a name="line-85"></a>    <span class="kt">void</span> <span class="nf">ResumeFromSync</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>
<a name="line-86"></a>
<a name="line-87"></a>    <span class="c1">//! Start sizing communication buffers and setting up ghost data</span>
<a name="line-88"></a>    <span class="kt">void</span> <span class="nf">resizeComm</span><span class="p">();</span>
<a name="line-89"></a>
<a name="line-90"></a>    <span class="c1">//! Receive unique set of faces we potentially share with/from another chare</span>
<a name="line-91"></a>    <span class="kt">void</span> <span class="nf">comfac</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">FaceSet</span><span class="o">&amp;</span> <span class="n">infaces</span> <span class="p">);</span>
<a name="line-92"></a>
<a name="line-93"></a>    <span class="c1">//! Receive ghost data on chare boundaries from fellow chare</span>
<a name="line-94"></a>    <span class="kt">void</span> <span class="nf">comGhost</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span> <span class="k">const</span> <span class="n">GhostData</span><span class="o">&amp;</span> <span class="n">ghost</span> <span class="p">);</span>
<a name="line-95"></a>
<a name="line-96"></a>    <span class="c1">//! Receive requests for ghost data</span>
<a name="line-97"></a>    <span class="kt">void</span> <span class="nf">reqGhost</span><span class="p">();</span>
<a name="line-98"></a>
<a name="line-99"></a>    <span class="c1">//! Send all of our ghost data to fellow chares</span>
<a name="line-100"></a>    <span class="kt">void</span> <span class="nf">sendGhost</span><span class="p">();</span>
<a name="line-101"></a>
<a name="line-102"></a>    <span class="c1">//! Setup node-neighborhood (esup)</span>
<a name="line-103"></a>    <span class="kt">void</span> <span class="nf">nodeNeighSetup</span><span class="p">();</span>
<a name="line-104"></a>
<a name="line-105"></a>    <span class="c1">//! Receive element-surr-points data on chare boundaries from fellow chare</span>
<a name="line-106"></a>    <span class="kt">void</span> <span class="nf">comEsup</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-107"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span>
<a name="line-108"></a>        <span class="n">bndEsup</span><span class="p">,</span>
<a name="line-109"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span>
<a name="line-110"></a>        <span class="n">nodeBndCells</span> <span class="p">);</span>
<a name="line-111"></a>
<a name="line-112"></a>    <span class="c1">//! Configure Charm++ reduction types for concatenating BC nodelists</span>
<a name="line-113"></a>    <span class="k">static</span> <span class="kt">void</span> <span class="n">registerReducers</span><span class="p">();</span>
<a name="line-114"></a>
<a name="line-115"></a>    <span class="c1">//! Setup: query boundary conditions, output mesh, etc.</span>
<a name="line-116"></a>    <span class="kt">void</span> <span class="nf">setup</span><span class="p">();</span>
<a name="line-117"></a>
<a name="line-118"></a>    <span class="c1">//! Receive total box IC volume and set conditions in box</span>
<a name="line-119"></a>    <span class="kt">void</span> <span class="nf">box</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">v</span> <span class="p">);</span>
<a name="line-120"></a>
<a name="line-121"></a>    <span class="c1">// Evaluate whether to do load balancing</span>
<a name="line-122"></a>    <span class="kt">void</span> <span class="nf">evalLB</span><span class="p">(</span> <span class="kt">int</span> <span class="n">nrestart</span> <span class="p">);</span>
<a name="line-123"></a>
<a name="line-124"></a>    <span class="c1">//! Start time stepping</span>
<a name="line-125"></a>    <span class="kt">void</span> <span class="nf">start</span><span class="p">();</span>
<a name="line-126"></a>
<a name="line-127"></a>    <span class="c1">//! Continue to next time step</span>
<a name="line-128"></a>    <span class="kt">void</span> <span class="nf">next</span><span class="p">();</span>
<a name="line-129"></a>
<a name="line-130"></a>    <span class="c1">//! Receive chare-boundary limiter function data from neighboring chares</span>
<a name="line-131"></a>    <span class="kt">void</span> <span class="nf">comlim</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-132"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">tetid</span><span class="p">,</span>
<a name="line-133"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">u</span><span class="p">,</span>
<a name="line-134"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">prim</span><span class="p">,</span>
<a name="line-135"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">ndof</span> <span class="p">);</span>
<a name="line-136"></a>
<a name="line-137"></a>    <span class="c1">//! Receive chare-boundary reconstructed data from neighboring chares</span>
<a name="line-138"></a>    <span class="kt">void</span> <span class="nf">comreco</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-139"></a>                  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">tetid</span><span class="p">,</span>
<a name="line-140"></a>                  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">u</span><span class="p">,</span>
<a name="line-141"></a>                  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">prim</span><span class="p">,</span>
<a name="line-142"></a>                  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">ndof</span> <span class="p">);</span>
<a name="line-143"></a>
<a name="line-144"></a>    <span class="c1">//! Receive chare-boundary ghost data from neighboring chares</span>
<a name="line-145"></a>    <span class="kt">void</span> <span class="nf">comsol</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-146"></a>                 <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">fromstage</span><span class="p">,</span>
<a name="line-147"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">tetid</span><span class="p">,</span>
<a name="line-148"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">u</span><span class="p">,</span>
<a name="line-149"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">prim</span><span class="p">,</span>
<a name="line-150"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">ndof</span> <span class="p">);</span>
<a name="line-151"></a>
<a name="line-152"></a>    <span class="c1">//! Receive contributions to nodal gradients on chare-boundaries</span>
<a name="line-153"></a>    <span class="kt">void</span>
<a name="line-154"></a>    <span class="nf">comnodalExtrema</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-155"></a>                     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">G1</span><span class="p">,</span>
<a name="line-156"></a>                     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">G2</span> <span class="p">);</span>
<a name="line-157"></a>
<a name="line-158"></a>    <span class="c1">//! Initialize the vector of nodal extrema</span>
<a name="line-159"></a>    <span class="kt">void</span> <span class="nf">resizeNodalExtremac</span><span class="p">();</span>
<a name="line-160"></a>
<a name="line-161"></a>    <span class="c1">//! Compute the nodal extrema for chare-boundary nodes</span>
<a name="line-162"></a>    <span class="kt">void</span> <span class="nf">evalNodalExtrm</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">ncomp</span><span class="p">,</span>
<a name="line-163"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">nprim</span><span class="p">,</span>
<a name="line-164"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">ndof_NodalExtrm</span><span class="p">,</span>
<a name="line-165"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">bndel</span><span class="p">,</span>
<a name="line-166"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span><span class="p">,</span>
<a name="line-167"></a>                         <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span><span class="o">&amp;</span> <span class="n">coord</span><span class="p">,</span>
<a name="line-168"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-169"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span>
<a name="line-170"></a>                           <span class="n">bid</span><span class="p">,</span>
<a name="line-171"></a>                         <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="o">&amp;</span> <span class="n">U</span><span class="p">,</span>
<a name="line-172"></a>                         <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="o">&amp;</span> <span class="n">P</span><span class="p">,</span>
<a name="line-173"></a>                         <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">uNodalExtrm</span><span class="p">,</span>
<a name="line-174"></a>                         <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">pNodalExtrm</span> <span class="p">);</span>
<a name="line-175"></a>
<a name="line-176"></a>    <span class="c1">//! \brief Receive nodal solution (ofor field output) contributions from</span>
<a name="line-177"></a>    <span class="c1">//!   neighboring chares</span>
<a name="line-178"></a>    <span class="kt">void</span> <span class="nf">comnodeout</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-179"></a>                     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">nesup</span><span class="p">,</span>
<a name="line-180"></a>                     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">L</span> <span class="p">);</span>
<a name="line-181"></a>
<a name="line-182"></a>    <span class="c1">//! Optionally refine/derefine mesh</span>
<a name="line-183"></a>    <span class="kt">void</span> <span class="nf">refine</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;&amp;</span> <span class="n">l2res</span> <span class="p">);</span>
<a name="line-184"></a>
<a name="line-185"></a>    <span class="c1">//! Receive new mesh from Refiner</span>
<a name="line-186"></a>    <span class="kt">void</span> <span class="nf">resizePostAMR</span><span class="p">(</span>
<a name="line-187"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="cm">/* ginpoel */</span><span class="p">,</span>
<a name="line-188"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Chunk</span><span class="o">&amp;</span> <span class="n">chunk</span><span class="p">,</span>
<a name="line-189"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span><span class="o">&amp;</span> <span class="n">coord</span><span class="p">,</span>
<a name="line-190"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Edge</span> <span class="o">&gt;&amp;</span> <span class="cm">/* addedNodes */</span><span class="p">,</span>
<a name="line-191"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">addedTets</span><span class="p">,</span>
<a name="line-192"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="cm">/*removedNodes*/</span><span class="p">,</span>
<a name="line-193"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">NodeCommMap</span><span class="o">&amp;</span> <span class="n">nodeCommMap</span><span class="p">,</span>
<a name="line-194"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">bface</span><span class="p">,</span>
<a name="line-195"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="cm">/* bnode */</span><span class="p">,</span>
<a name="line-196"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">triinpoel</span> <span class="p">);</span>
<a name="line-197"></a>
<a name="line-198"></a>    <span class="c1">//! Extract field output going to file</span>
<a name="line-199"></a>    <span class="kt">void</span> <span class="nf">extractFieldOutput</span><span class="p">(</span>
<a name="line-200"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="cm">/* ginpoel */</span><span class="p">,</span>
<a name="line-201"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Chunk</span><span class="o">&amp;</span> <span class="n">chunk</span><span class="p">,</span>
<a name="line-202"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span><span class="o">&amp;</span> <span class="n">coord</span><span class="p">,</span>
<a name="line-203"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Edge</span> <span class="o">&gt;&amp;</span> <span class="cm">/* addedNodes */</span><span class="p">,</span>
<a name="line-204"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">addedTets</span><span class="p">,</span>
<a name="line-205"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">NodeCommMap</span><span class="o">&amp;</span> <span class="n">nodeCommMap</span><span class="p">,</span>
<a name="line-206"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">bface</span><span class="p">,</span>
<a name="line-207"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="cm">/* bnode */</span><span class="p">,</span>
<a name="line-208"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">triinpoel</span><span class="p">,</span>
<a name="line-209"></a>      <span class="n">CkCallback</span> <span class="n">c</span> <span class="p">);</span>
<a name="line-210"></a>
<a name="line-211"></a>    <span class="c1">//! Const-ref access to current solution</span>
<a name="line-212"></a>    <span class="c1">//! \return Const-ref to current solution</span>
<a name="line-213"></a>    <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="o">&amp;</span> <span class="n">solution</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_u</span><span class="p">;</span> <span class="p">}</span>
<a name="line-214"></a>
<a name="line-215"></a>    <span class="c1">//! Compute left hand side</span>
<a name="line-216"></a>    <span class="kt">void</span> <span class="n">lhs</span><span class="p">();</span>
<a name="line-217"></a>
<a name="line-218"></a>    <span class="c1">//! Unused in DG</span>
<a name="line-219"></a>    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="p">{}</span>
<a name="line-220"></a>
<a name="line-221"></a>    <span class="c1">//! Compute right hand side and solve system</span>
<a name="line-222"></a>    <span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">newdt</span> <span class="p">);</span>
<a name="line-223"></a>
<a name="line-224"></a>    <span class="c1">//! Evaluate whether to continue with next time step</span>
<a name="line-225"></a>    <span class="kt">void</span> <span class="nf">step</span><span class="p">();</span>
<a name="line-226"></a>
<a name="line-227"></a>    <span class="cm">/** @name Charm++ pack/unpack serializer member functions */</span>
<a name="line-228"></a>    <span class="c1">///@{</span>
<a name="line-229"></a>    <span class="c1">//! \brief Pack/Unpack serialize member function</span>
<a name="line-230"></a>    <span class="c1">//! \param[in,out] p Charm++&#39;s PUP::er serializer object reference</span>
<a name="line-231"></a>    <span class="kt">void</span> <span class="nf">pup</span><span class="p">(</span> <span class="n">PUP</span><span class="o">::</span><span class="n">er</span> <span class="o">&amp;</span><span class="n">p</span> <span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
<a name="line-232"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_disc</span><span class="p">;</span>
<a name="line-233"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ndof_NodalExtrm</span><span class="p">;</span>
<a name="line-234"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ncomfac</span><span class="p">;</span>
<a name="line-235"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nadj</span><span class="p">;</span>
<a name="line-236"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ncomEsup</span><span class="p">;</span>
<a name="line-237"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nsol</span><span class="p">;</span>
<a name="line-238"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ninitsol</span><span class="p">;</span>
<a name="line-239"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nlim</span><span class="p">;</span>
<a name="line-240"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nnod</span><span class="p">;</span>
<a name="line-241"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nreco</span><span class="p">;</span>
<a name="line-242"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nnodalExtrema</span><span class="p">;</span>
<a name="line-243"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_inpoel</span><span class="p">;</span>
<a name="line-244"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_coord</span><span class="p">;</span>
<a name="line-245"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_fd</span><span class="p">;</span>
<a name="line-246"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_u</span><span class="p">;</span>
<a name="line-247"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_un</span><span class="p">;</span>
<a name="line-248"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_p</span><span class="p">;</span>
<a name="line-249"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_geoFace</span><span class="p">;</span>
<a name="line-250"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_geoElem</span><span class="p">;</span>
<a name="line-251"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_lhs</span><span class="p">;</span>
<a name="line-252"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_uNodalExtrm</span><span class="p">;</span>
<a name="line-253"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_pNodalExtrm</span><span class="p">;</span>
<a name="line-254"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_uNodalExtrmc</span><span class="p">;</span>
<a name="line-255"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_pNodalExtrmc</span><span class="p">;</span>
<a name="line-256"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_rhs</span><span class="p">;</span>
<a name="line-257"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nfac</span><span class="p">;</span>
<a name="line-258"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nunk</span><span class="p">;</span>
<a name="line-259"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_npoin</span><span class="p">;</span>
<a name="line-260"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ipface</span><span class="p">;</span>
<a name="line-261"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_bndFace</span><span class="p">;</span>
<a name="line-262"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ghostData</span><span class="p">;</span>
<a name="line-263"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_sendGhost</span><span class="p">;</span>
<a name="line-264"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ghostReq</span><span class="p">;</span>
<a name="line-265"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ghost</span><span class="p">;</span>
<a name="line-266"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_exptGhost</span><span class="p">;</span>
<a name="line-267"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_recvGhost</span><span class="p">;</span>
<a name="line-268"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_diag</span><span class="p">;</span>
<a name="line-269"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_stage</span><span class="p">;</span>
<a name="line-270"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ndof</span><span class="p">;</span>
<a name="line-271"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_numEqDof</span><span class="p">;</span>
<a name="line-272"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_bid</span><span class="p">;</span>
<a name="line-273"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_uc</span><span class="p">;</span>
<a name="line-274"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_pc</span><span class="p">;</span>
<a name="line-275"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_ndofc</span><span class="p">;</span>
<a name="line-276"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_initial</span><span class="p">;</span>
<a name="line-277"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_expChBndFace</span><span class="p">;</span>
<a name="line-278"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_infaces</span><span class="p">;</span>
<a name="line-279"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_esup</span><span class="p">;</span>
<a name="line-280"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_esupc</span><span class="p">;</span>
<a name="line-281"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_elemfields</span><span class="p">;</span>
<a name="line-282"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nodefields</span><span class="p">;</span>
<a name="line-283"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_nodefieldsc</span><span class="p">;</span>
<a name="line-284"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_outmesh</span><span class="p">;</span>
<a name="line-285"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_boxelems</span><span class="p">;</span>
<a name="line-286"></a>      <span class="n">p</span> <span class="o">|</span> <span class="n">m_shockmarker</span><span class="p">;</span>
<a name="line-287"></a>    <span class="p">}</span>
<a name="line-288"></a>    <span class="c1">//! \brief Pack/Unpack serialize operator|</span>
<a name="line-289"></a>    <span class="c1">//! \param[in,out] p Charm++&#39;s PUP::er serializer object reference</span>
<a name="line-290"></a>    <span class="c1">//! \param[in,out] i DG object reference</span>
<a name="line-291"></a>    <span class="k">friend</span> <span class="kt">void</span> <span class="k">operator</span><span class="o">|</span><span class="p">(</span> <span class="n">PUP</span><span class="o">::</span><span class="n">er</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">,</span> <span class="n">DG</span><span class="o">&amp;</span> <span class="n">i</span> <span class="p">)</span> <span class="p">{</span> <span class="n">i</span><span class="p">.</span><span class="n">pup</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="p">}</span>
<a name="line-292"></a>    <span class="c1">//@}</span>
<a name="line-293"></a>
<a name="line-294"></a>  <span class="k">private</span><span class="o">:</span>
<a name="line-295"></a>    <span class="c1">//! Local face &amp; tet IDs associated to 3 global node IDs</span>
<a name="line-296"></a>    <span class="c1">//! \details This map stores tetrahedron cell faces (map key) and their</span>
<a name="line-297"></a>    <span class="c1">//!   associated local face ID and inner local tet id adjacent to the face</span>
<a name="line-298"></a>    <span class="c1">//!   (map value). A face is given by 3 global node IDs.</span>
<a name="line-299"></a>    <span class="k">using</span> <span class="n">FaceMap</span> <span class="o">=</span>
<a name="line-300"></a>      <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Face</span><span class="p">,</span>  <span class="c1">// 3 global node IDs</span>
<a name="line-301"></a>                          <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&gt;</span><span class="p">,</span> <span class="c1">// local face &amp; tet ID</span>
<a name="line-302"></a>                          <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Hash</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">,</span>
<a name="line-303"></a>                          <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Eq</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-304"></a>
<a name="line-305"></a>    <span class="c1">//! Storage type for refined mesh used for field output</span>
<a name="line-306"></a>    <span class="k">struct</span> <span class="nc">OutMesh</span> <span class="p">{</span>
<a name="line-307"></a>      <span class="c1">//! Element connectivity, local-&gt;global node ids, global-&gt;local nodes ids</span>
<a name="line-308"></a>      <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Chunk</span> <span class="n">chunk</span><span class="p">;</span>
<a name="line-309"></a>      <span class="c1">//! Node coordinates</span>
<a name="line-310"></a>      <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span> <span class="n">coord</span><span class="p">;</span>
<a name="line-311"></a>      <span class="c1">//! Triangle element connectivity</span>
<a name="line-312"></a>      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">triinpoel</span><span class="p">;</span>
<a name="line-313"></a>      <span class="c1">//! Boundary-face connectivity</span>
<a name="line-314"></a>      <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">bface</span><span class="p">;</span>
<a name="line-315"></a>      <span class="c1">//! Node communinaction map</span>
<a name="line-316"></a>      <span class="n">tk</span><span class="o">::</span><span class="n">NodeCommMap</span> <span class="n">nodeCommMap</span><span class="p">;</span>
<a name="line-317"></a>      <span class="c1">//! \brief Pack/Unpack serialize member function</span>
<a name="line-318"></a>      <span class="c1">//! \param[in,out] p Charm++&#39;s PUP::er serializer object reference</span>
<a name="line-319"></a><span class="hll">      <span class="kt">void</span> <span class="nf">pup</span><span class="p">(</span> <span class="n">PUP</span><span class="o">::</span><span class="n">er</span><span class="o">&amp;</span> <span class="n">p</span> <span class="p">)</span> <span class="p">{</span><span class="error2">&lt;--- Parameter 'p' can be declared with const</span>
</span><a name="line-320"></a>        <span class="n">p</span><span class="o">|</span><span class="n">chunk</span><span class="p">;</span> <span class="n">p</span><span class="o">|</span><span class="n">coord</span><span class="p">;</span> <span class="n">p</span><span class="o">|</span><span class="n">triinpoel</span><span class="p">;</span> <span class="n">p</span><span class="o">|</span><span class="n">bface</span><span class="p">;</span> <span class="n">p</span><span class="o">|</span><span class="n">nodeCommMap</span><span class="p">;</span>
<a name="line-321"></a>      <span class="p">}</span>
<a name="line-322"></a>      <span class="c1">//! Destroyer</span>
<a name="line-323"></a>      <span class="kt">void</span> <span class="nf">destroy</span><span class="p">()</span> <span class="p">{</span>
<a name="line-324"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="p">);</span>
<a name="line-325"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="p">);</span>
<a name="line-326"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="p">);</span>
<a name="line-327"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
<a name="line-328"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
<a name="line-329"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">);</span>
<a name="line-330"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">triinpoel</span> <span class="p">);</span>
<a name="line-331"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">bface</span> <span class="p">);</span>
<a name="line-332"></a>        <span class="n">tk</span><span class="o">::</span><span class="n">destroy</span><span class="p">(</span> <span class="n">nodeCommMap</span> <span class="p">);</span>
<a name="line-333"></a>      <span class="p">}</span>
<a name="line-334"></a>    <span class="p">};</span>
<a name="line-335"></a>
<a name="line-336"></a>    <span class="c1">//! Discretization proxy</span>
<a name="line-337"></a>    <span class="n">CProxy_Discretization</span> <span class="n">m_disc</span><span class="p">;</span>
<a name="line-338"></a>    <span class="c1">//! \brief Degree of freedom for nodal extrema vector. When DGP1 is applied,</span>
<a name="line-339"></a>    <span class="c1">//!   there is one degree of freedom for cell average variable. When DGP2 is</span>
<a name="line-340"></a>    <span class="c1">//!   applied, the degree of freedom is 4 which refers to cell average and</span>
<a name="line-341"></a>    <span class="c1">//!   gradients in three directions</span>
<a name="line-342"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ndof_NodalExtrm</span><span class="p">;</span>
<a name="line-343"></a>    <span class="c1">//! Counter for face adjacency communication map</span>
<a name="line-344"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ncomfac</span><span class="p">;</span>
<a name="line-345"></a>    <span class="c1">//! Counter signaling that all ghost data have been received</span>
<a name="line-346"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nadj</span><span class="p">;</span>
<a name="line-347"></a>    <span class="c1">//! Counter for element-surr-node adjacency communication map</span>
<a name="line-348"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ncomEsup</span><span class="p">;</span>
<a name="line-349"></a>    <span class="c1">//! Counter signaling that we have received all our solution ghost data</span>
<a name="line-350"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nsol</span><span class="p">;</span>
<a name="line-351"></a>    <span class="c1">//! \brief Counter signaling that we have received all our solution ghost</span>
<a name="line-352"></a>    <span class="c1">//!    data during setup</span>
<a name="line-353"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ninitsol</span><span class="p">;</span>
<a name="line-354"></a>    <span class="c1">//! \brief Counter signaling that we have received all our limiter function</span>
<a name="line-355"></a>    <span class="c1">//!   ghost data</span>
<a name="line-356"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nlim</span><span class="p">;</span>
<a name="line-357"></a>    <span class="c1">//! \brief Counter signaling that we have received all our node solution</span>
<a name="line-358"></a>    <span class="c1">//!   contributions</span>
<a name="line-359"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nnod</span><span class="p">;</span>
<a name="line-360"></a>    <span class="c1">//! Counter signaling that we have received all our reconstructed ghost data</span>
<a name="line-361"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nreco</span><span class="p">;</span>
<a name="line-362"></a>    <span class="c1">//! \brief Counter signaling that we have received all our nodal extrema from</span>
<a name="line-363"></a>    <span class="c1">//!   ghost chare partitions</span>
<a name="line-364"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nnodalExtrema</span><span class="p">;</span>
<a name="line-365"></a>    <span class="c1">//! Mesh connectivity extended</span>
<a name="line-366"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_inpoel</span><span class="p">;</span>
<a name="line-367"></a>    <span class="c1">//! Node coordinates extended</span>
<a name="line-368"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span> <span class="n">m_coord</span><span class="p">;</span>
<a name="line-369"></a>    <span class="c1">//! Face data</span>
<a name="line-370"></a>    <span class="n">FaceData</span> <span class="n">m_fd</span><span class="p">;</span>
<a name="line-371"></a>    <span class="c1">//! Vector of unknown/solution average over each mesh element</span>
<a name="line-372"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_u</span><span class="p">;</span>
<a name="line-373"></a>    <span class="c1">//! Vector of unknown at previous time-step</span>
<a name="line-374"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_un</span><span class="p">;</span>
<a name="line-375"></a>    <span class="c1">//! Vector of primitive quantities over each mesh element</span>
<a name="line-376"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_p</span><span class="p">;</span>
<a name="line-377"></a>    <span class="c1">//! Face geometry</span>
<a name="line-378"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_geoFace</span><span class="p">;</span>
<a name="line-379"></a>    <span class="c1">//! Element geometry</span>
<a name="line-380"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_geoElem</span><span class="p">;</span>
<a name="line-381"></a>    <span class="c1">//! Left-hand side mass-matrix which is a diagonal matrix</span>
<a name="line-382"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_lhs</span><span class="p">;</span>
<a name="line-383"></a>    <span class="c1">//! Vector of right-hand side</span>
<a name="line-384"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="n">m_rhs</span><span class="p">;</span>
<a name="line-385"></a>    <span class="c1">//! Vector of nodal extrema for conservative variables</span>
<a name="line-386"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_uNodalExtrm</span><span class="p">;</span>
<a name="line-387"></a>    <span class="c1">//! Vector of nodal extrema for primitive variables</span>
<a name="line-388"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_pNodalExtrm</span><span class="p">;</span>
<a name="line-389"></a>    <span class="c1">//! Buffer for vector of nodal extrema for conservative variables</span>
<a name="line-390"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_uNodalExtrmc</span><span class="p">;</span>
<a name="line-391"></a>    <span class="c1">//! Buffer for vector of nodal extrema for primitive variables</span>
<a name="line-392"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_pNodalExtrmc</span><span class="p">;</span>
<a name="line-393"></a>    <span class="c1">//! Counter for number of faces on this chare (including chare boundaries)</span>
<a name="line-394"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nfac</span><span class="p">;</span>
<a name="line-395"></a>    <span class="c1">//! Counter for number of unknowns on this chare (including ghosts)</span>
<a name="line-396"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nunk</span><span class="p">;</span>
<a name="line-397"></a>    <span class="c1">//! Counter for number of nodes on this chare excluding ghosts</span>
<a name="line-398"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_npoin</span><span class="p">;</span>
<a name="line-399"></a>    <span class="c1">//! Internal + physical boundary faces (inverse of inpofa)</span>
<a name="line-400"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">FaceSet</span> <span class="n">m_ipface</span><span class="p">;</span>
<a name="line-401"></a>    <span class="c1">//! Face &amp; tet IDs associated to global node IDs of the face for each chare</span>
<a name="line-402"></a>    <span class="c1">//! \details This map stores not only the unique faces associated to</span>
<a name="line-403"></a>    <span class="c1">//!   fellow chares, but also a newly assigned local face ID and adjacent</span>
<a name="line-404"></a>    <span class="c1">//!   local tet ID.</span>
<a name="line-405"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">FaceMap</span> <span class="o">&gt;</span> <span class="n">m_bndFace</span><span class="p">;</span>
<a name="line-406"></a>    <span class="c1">//! Ghost data associated to chare IDs we communicate with</span>
<a name="line-407"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">GhostData</span> <span class="o">&gt;</span> <span class="n">m_ghostData</span><span class="p">;</span>
<a name="line-408"></a>    <span class="c1">//! Elements which are ghosts for other chares associated to those chare IDs</span>
<a name="line-409"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_sendGhost</span><span class="p">;</span>
<a name="line-410"></a>    <span class="c1">//! Number of chares requesting ghost data</span>
<a name="line-411"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ghostReq</span><span class="p">;</span>
<a name="line-412"></a>    <span class="c1">//! Local element id associated to ghost remote id charewise</span>
<a name="line-413"></a>    <span class="c1">//! \details This map associates the local element id (inner map value) to</span>
<a name="line-414"></a>    <span class="c1">//!    the (remote) element id of the ghost (inner map key) based on the</span>
<a name="line-415"></a>    <span class="c1">//!    chare id (outer map key) this remote element lies in.</span>
<a name="line-416"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span>
<a name="line-417"></a>      <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_ghost</span><span class="p">;</span>
<a name="line-418"></a>    <span class="c1">//! Expected ghost tet ids (used only in DEBUG)</span>
<a name="line-419"></a>    <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_exptGhost</span><span class="p">;</span>
<a name="line-420"></a>    <span class="c1">//! Received ghost tet ids (used only in DEBUG)</span>
<a name="line-421"></a>    <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_recvGhost</span><span class="p">;</span>
<a name="line-422"></a>    <span class="c1">//! Diagnostics object</span>
<a name="line-423"></a>    <span class="n">ElemDiagnostics</span> <span class="n">m_diag</span><span class="p">;</span>
<a name="line-424"></a>    <span class="c1">//! Runge-Kutta stage counter</span>
<a name="line-425"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_stage</span><span class="p">;</span>
<a name="line-426"></a>    <span class="c1">//! Vector of local number of degrees of freedom for each element</span>
<a name="line-427"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_ndof</span><span class="p">;</span>
<a name="line-428"></a>    <span class="c1">//! Vector of number of degrees of freedom for each PDE equation/component</span>
<a name="line-429"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_numEqDof</span><span class="p">;</span>
<a name="line-430"></a>    <span class="c1">//! Map local ghost tet ids (value) and zero-based boundary ids (key)</span>
<a name="line-431"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_bid</span><span class="p">;</span>
<a name="line-432"></a>    <span class="c1">//! Solution receive buffers for ghosts only</span>
<a name="line-433"></a>    <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">m_uc</span><span class="p">;</span>
<a name="line-434"></a>    <span class="c1">//! Primitive-variable receive buffers for ghosts only</span>
<a name="line-435"></a>    <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">m_pc</span><span class="p">;</span>
<a name="line-436"></a>    <span class="c1">//! \brief Number of degrees of freedom (for p-adaptive) receive buffers</span>
<a name="line-437"></a>    <span class="c1">//!   for ghosts only</span>
<a name="line-438"></a>    <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">m_ndofc</span><span class="p">;</span>
<a name="line-439"></a>    <span class="c1">//! 1 if starting time stepping, 0 if during time stepping</span>
<a name="line-440"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_initial</span><span class="p">;</span>
<a name="line-441"></a>    <span class="c1">//! Unique set of chare-boundary faces this chare is expected to receive</span>
<a name="line-442"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">FaceSet</span> <span class="n">m_expChBndFace</span><span class="p">;</span>
<a name="line-443"></a>    <span class="c1">//! Incoming communication buffer during chare-boundary face communication</span>
<a name="line-444"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">FaceSet</span> <span class="o">&gt;</span> <span class="n">m_infaces</span><span class="p">;</span>
<a name="line-445"></a>    <span class="c1">//! Elements (value) surrounding point (key) data-structure</span>
<a name="line-446"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_esup</span><span class="p">;</span>
<a name="line-447"></a>    <span class="c1">//! Communication buffer for esup data-structure</span>
<a name="line-448"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_esupc</span><span class="p">;</span>
<a name="line-449"></a>    <span class="c1">//! Elem output fields</span>
<a name="line-450"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_elemfields</span><span class="p">;</span>
<a name="line-451"></a>    <span class="c1">//! Node output fields</span>
<a name="line-452"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_nodefields</span><span class="p">;</span>
<a name="line-453"></a>    <span class="c1">//! Receive buffer for communication of node output fields</span>
<a name="line-454"></a>    <span class="c1">//! \details Key: global node id, value: output fields and number of</span>
<a name="line-455"></a>    <span class="c1">//!   elements surrounding the node</span>
<a name="line-456"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span><span class="p">,</span>
<a name="line-457"></a>                                                <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_nodefieldsc</span><span class="p">;</span>
<a name="line-458"></a>    <span class="c1">//! Storage for refined mesh used for field output</span>
<a name="line-459"></a>    <span class="n">OutMesh</span> <span class="n">m_outmesh</span><span class="p">;</span>
<a name="line-460"></a>    <span class="c1">//! Element ids at which box ICs are defined by user (multiple boxes)</span>
<a name="line-461"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_boxelems</span><span class="p">;</span>
<a name="line-462"></a>    <span class="c1">//! Shock detection marker for field output</span>
<a name="line-463"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_shockmarker</span><span class="p">;</span>
<a name="line-464"></a>
<a name="line-465"></a>    <span class="c1">//! Access bound Discretization class pointer</span>
<a name="line-466"></a>    <span class="n">Discretization</span><span class="o">*</span> <span class="nf">Disc</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
<a name="line-467"></a>      <span class="n">Assert</span><span class="p">(</span> <span class="n">m_disc</span><span class="p">[</span> <span class="n">thisIndex</span> <span class="p">].</span><span class="n">ckLocal</span><span class="p">()</span> <span class="o">!=</span> <span class="k">nullptr</span><span class="p">,</span> <span class="s">&quot;ckLocal() null&quot;</span> <span class="p">);</span>
<a name="line-468"></a>      <span class="k">return</span> <span class="n">m_disc</span><span class="p">[</span> <span class="n">thisIndex</span> <span class="p">].</span><span class="n">ckLocal</span><span class="p">();</span>
<a name="line-469"></a>    <span class="p">}</span>
<a name="line-470"></a>
<a name="line-471"></a>    <span class="c1">//! Compute partial boundary surface integral and sum across all chares</span>
<a name="line-472"></a>    <span class="kt">void</span> <span class="nf">bndIntegral</span><span class="p">();</span>
<a name="line-473"></a>
<a name="line-474"></a>    <span class="c1">//! Compute chare-boundary faces</span>
<a name="line-475"></a>    <span class="kt">void</span> <span class="nf">bndFaces</span><span class="p">();</span>
<a name="line-476"></a>
<a name="line-477"></a>    <span class="c1">//! Perform leak test on chare-boundary faces</span>
<a name="line-478"></a>    <span class="kt">bool</span> <span class="nf">leakyAdjacency</span><span class="p">();</span>
<a name="line-479"></a>
<a name="line-480"></a>    <span class="c1">//! Check if esuf of chare-boundary faces matches</span>
<a name="line-481"></a>    <span class="kt">bool</span> <span class="nf">faceMatch</span><span class="p">();</span>
<a name="line-482"></a>
<a name="line-483"></a>    <span class="c1">//! Verify that all chare-boundary faces have been received</span>
<a name="line-484"></a>    <span class="kt">bool</span> <span class="nf">receivedChBndFaces</span><span class="p">();</span>
<a name="line-485"></a>
<a name="line-486"></a>    <span class="c1">//! Check if entries in inpoel, inpofa and node-triplet are consistent</span>
<a name="line-487"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span>
<a name="line-488"></a>    <span class="n">nodetripletMatch</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&gt;&amp;</span> <span class="n">id</span><span class="p">,</span>
<a name="line-489"></a>                      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Face</span><span class="o">&amp;</span> <span class="n">t</span> <span class="p">);</span>
<a name="line-490"></a>
<a name="line-491"></a>    <span class="c1">//! Find any chare for face (given by 3 global node IDs)</span>
<a name="line-492"></a>    <span class="kt">int</span> <span class="nf">findchare</span><span class="p">(</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Face</span><span class="o">&amp;</span> <span class="n">t</span> <span class="p">);</span>
<a name="line-493"></a>
<a name="line-494"></a>    <span class="c1">//! Setup own ghost data on this chare</span>
<a name="line-495"></a>    <span class="kt">void</span> <span class="nf">setupGhost</span><span class="p">();</span>
<a name="line-496"></a>
<a name="line-497"></a>    <span class="c1">//! Continue after face adjacency communication map completed on this chare</span>
<a name="line-498"></a>    <span class="kt">void</span> <span class="nf">faceAdj</span><span class="p">();</span>
<a name="line-499"></a>
<a name="line-500"></a>    <span class="c1">//! Continue after node adjacency communication map completed on this chare</span>
<a name="line-501"></a>    <span class="kt">void</span> <span class="nf">adj</span><span class="p">();</span>
<a name="line-502"></a>
<a name="line-503"></a>    <span class="c1">//! Fill elements surrounding a face along chare boundary</span>
<a name="line-504"></a>    <span class="kt">void</span> <span class="nf">addEsuf</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&gt;&amp;</span> <span class="n">id</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">ghostid</span> <span class="p">);</span>
<a name="line-505"></a>
<a name="line-506"></a>    <span class="c1">//! Fill elements surrounding a element along chare boundary</span>
<a name="line-507"></a>    <span class="kt">void</span> <span class="nf">addEsuel</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&gt;&amp;</span> <span class="n">id</span><span class="p">,</span>
<a name="line-508"></a>                   <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">ghostid</span><span class="p">,</span>
<a name="line-509"></a>                   <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Face</span><span class="o">&amp;</span> <span class="n">t</span> <span class="p">);</span>
<a name="line-510"></a>
<a name="line-511"></a>    <span class="kt">void</span> <span class="nf">addEsup</span><span class="p">();</span>
<a name="line-512"></a>
<a name="line-513"></a>    <span class="c1">//! Fill face geometry data along chare boundary</span>
<a name="line-514"></a>    <span class="kt">void</span> <span class="nf">addGeoFace</span><span class="p">(</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Face</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">,</span>
<a name="line-515"></a>                     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&gt;&amp;</span> <span class="n">id</span> <span class="p">);</span>
<a name="line-516"></a>
<a name="line-517"></a>    <span class="c1">//! Output mesh field data</span>
<a name="line-518"></a>    <span class="kt">void</span> <span class="nf">writeFields</span><span class="p">(</span> <span class="n">CkCallback</span> <span class="n">c</span> <span class="p">);</span>
<a name="line-519"></a>
<a name="line-520"></a>    <span class="c1">//! Compute solution reconstructions</span>
<a name="line-521"></a>    <span class="kt">void</span> <span class="nf">reco</span><span class="p">();</span>
<a name="line-522"></a>
<a name="line-523"></a>    <span class="c1">//! Compute nodal extrema at chare-boundary nodes</span>
<a name="line-524"></a>    <span class="kt">void</span> <span class="nf">nodalExtrema</span><span class="p">();</span>
<a name="line-525"></a>
<a name="line-526"></a>    <span class="c1">//! Compute limiter function</span>
<a name="line-527"></a>    <span class="kt">void</span> <span class="nf">lim</span><span class="p">();</span>
<a name="line-528"></a>
<a name="line-529"></a>    <span class="c1">//! Compute time step size</span>
<a name="line-530"></a>    <span class="kt">void</span> <span class="nf">dt</span><span class="p">();</span>
<a name="line-531"></a>
<a name="line-532"></a>    <span class="c1">//! Evaluate whether to continue with next time step stage</span>
<a name="line-533"></a>    <span class="kt">void</span> <span class="nf">stage</span><span class="p">();</span>
<a name="line-534"></a>
<a name="line-535"></a>    <span class="c1">//! Evaluate whether to save checkpoint/restart</span>
<a name="line-536"></a>    <span class="kt">void</span> <span class="nf">evalRestart</span><span class="p">();</span>
<a name="line-537"></a>
<a name="line-538"></a>    <span class="c1">//! p-refine all elements that are adjacent to p-refined elements</span>
<a name="line-539"></a>    <span class="kt">void</span> <span class="nf">propagate_ndof</span><span class="p">();</span>
<a name="line-540"></a>
<a name="line-541"></a>    <span class="c1">//! Evaluate solution on incomping (a potentially refined) mesh</span>
<a name="line-542"></a>    <span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span> <span class="o">&gt;</span>
<a name="line-543"></a>    <span class="n">evalSolution</span><span class="p">(</span>
<a name="line-544"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span><span class="p">,</span>
<a name="line-545"></a>      <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span><span class="o">&amp;</span> <span class="n">coord</span><span class="p">,</span>
<a name="line-546"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">addedTets</span> <span class="p">);</span>
<a name="line-547"></a>
<a name="line-548"></a>    <span class="c1">//! Decide wether to output field data</span>
<a name="line-549"></a>    <span class="kt">bool</span> <span class="nf">fieldOutput</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
<a name="line-550"></a>
<a name="line-551"></a>    <span class="c1">//! Decide if we write field output using a refined mesh</span>
<a name="line-552"></a>    <span class="kt">bool</span> <span class="nf">refinedOutput</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
<a name="line-553"></a>
<a name="line-554"></a>    <span class="c1">//! Start preparing fields for output to file</span>
<a name="line-555"></a>    <span class="kt">void</span> <span class="nf">startFieldOutput</span><span class="p">(</span> <span class="n">CkCallback</span> <span class="n">c</span> <span class="p">);</span>
<a name="line-556"></a><span class="p">};</span>
<a name="line-557"></a>
<a name="line-558"></a><span class="p">}</span> <span class="c1">// inciter::</span>
<a name="line-559"></a>
<a name="line-560"></a><span class="cp">#endif </span><span class="c1">// DG_h</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
