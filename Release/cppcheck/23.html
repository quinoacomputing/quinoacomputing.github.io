
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href=https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND>-128-NOTFOUND</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [<a href=https://github.com/quinoacomputing/quinoa/commit/-128-NOTFOUND>-128-NOTFOUND</a>]: /tmp/TeamCity-1/work/5ad443c8abe7fc0a/src/Control/SystemComponents.hpp</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> SystemComponents.hpp</p>
<a href="23.html#line-162"> shadowFunction 162</a><a href="23.html#line-180"> shadowFunction 180</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/Control/SystemComponents.hpp</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015 J. Bakosi,</span>
<a name="line-5"></a><span class="cm">             2016-2018 Los Alamos National Security, LLC.,</span>
<a name="line-6"></a><span class="cm">             2019-2021 Triad National Security, LLC.</span>
<a name="line-7"></a><span class="cm">             All rights reserved. See the LICENSE file for details.</span>
<a name="line-8"></a><span class="cm">  \brief     Operations on numbers of scalar components of systems of equations</span>
<a name="line-9"></a><span class="cm">  \details   Operations on numbers of scalar components of systems of equations,</span>
<a name="line-10"></a><span class="cm">    e.g. multiple equation sets of a physical model or a set of (stochastic</span>
<a name="line-11"></a><span class="cm">    ordinary or partial differential) equations of different kinds.</span>
<a name="line-12"></a>
<a name="line-13"></a><span class="cm">    _Problem:_ We are given a type that is a tk::tuple::tagged_tuple that</span>
<a name="line-14"></a><span class="cm">    contains an arbitrary number of std::vectors of integers. The number of</span>
<a name="line-15"></a><span class="cm">    vectors are fixed at compile-time (accessed via tags) but their (differing)</span>
<a name="line-16"></a><span class="cm">    length is only known at run-time (after parsing user input). What we need</span>
<a name="line-17"></a><span class="cm">    are functions that operate on this data structure and return, e.g., the</span>
<a name="line-18"></a><span class="cm">    total number of components in the whole system or the offset in the whole</span>
<a name="line-19"></a><span class="cm">    data structure for a given tag. The functions should thus be able to operate</span>
<a name="line-20"></a><span class="cm">    on a list of types, i.e., a double for-loop over all tags and associated</span>
<a name="line-21"></a><span class="cm">    vectors - one at compile-time and the other one at run-time.</span>
<a name="line-22"></a>
<a name="line-23"></a><span class="cm">    _Example:_ An example is to define storage for systems of stochastic</span>
<a name="line-24"></a><span class="cm">    differential equations as in walker::ctr::ncomps. In</span>
<a name="line-25"></a><span class="cm">    [walker](walker.html) various types of stochastic differential</span>
<a name="line-26"></a><span class="cm">    equations are implemented and numerically integrated in time in order to</span>
<a name="line-27"></a><span class="cm">    compute and learn about their statistical behavior. Since different types of</span>
<a name="line-28"></a><span class="cm">    systems can be parameterized differently, there can be several systems of</span>
<a name="line-29"></a><span class="cm">    the same type (the number is user-defined so only known at run-time). For</span>
<a name="line-30"></a><span class="cm">    example, it is possible to numerically integrate two systems of Dirichlet</span>
<a name="line-31"></a><span class="cm">    equations, see DiffEq/Dirichlet.h, one with 4, the other one with 5 scalar</span>
<a name="line-32"></a><span class="cm">    variables, parameterized differently, and estimate their arbitrary coupled</span>
<a name="line-33"></a><span class="cm">    statistics and joint PDFs. This requires that each type of equation system</span>
<a name="line-34"></a><span class="cm">    has a vector of integers storing the number of scalar variables.</span>
<a name="line-35"></a>
<a name="line-36"></a><span class="cm">    _Solution:_ Looping through a list of types is done using the [Brigand]</span>
<a name="line-37"></a><span class="cm">    (https://github.com/edouarda/brigand)&#39;s [MetaProgramming Library].</span>
<a name="line-38"></a><span class="cm">    Such operations on types happen at compile-time, i.e., the code runs inside</span>
<a name="line-39"></a><span class="cm">    the compiler and only its result gets compiled into code to be run at</span>
<a name="line-40"></a><span class="cm">    run-time. Advantages are abstraction and generic code that is independent</span>
<a name="line-41"></a><span class="cm">    of the size and order of the tags in the tuple (and the associated vectors).</span>
<a name="line-42"></a><span class="cm">    Though it is not of primary concern for this data structure, this solution</span>
<a name="line-43"></a><span class="cm">    also generates efficient code, since part of the algorithm (for computing</span>
<a name="line-44"></a><span class="cm">    the offset, the total number of components, etc.) runs inside the compiler.</span>
<a name="line-45"></a><span class="cm">    All of this is kept generic, so it does not need to be changed when a new</span>
<a name="line-46"></a><span class="cm">    pair of tag and system of equations are added to the underlying tuple.</span>
<a name="line-47"></a><span class="cm">    Thus, _the main advantage is that changing the order of the vectors in the</span>
<a name="line-48"></a><span class="cm">    tuple or adding new ones at arbitrary locations will not require change to</span>
<a name="line-49"></a><span class="cm">    client-code._</span>
<a name="line-50"></a>
<a name="line-51"></a><span class="cm">    _An alternative approach:_ Of course this could have been simply done with a</span>
<a name="line-52"></a><span class="cm">    purely run-time vector of vector of integers. However, that would not have</span>
<a name="line-53"></a><span class="cm">    allowed a tag-based access to the different systems of equations. (Sure, one</span>
<a name="line-54"></a><span class="cm">    can define an enum for equation indexing, but that just adds code to what is</span>
<a name="line-55"></a><span class="cm">    already need to be changed if a change happens to the underlying data</span>
<a name="line-56"></a><span class="cm">    structure.) As a consequence, a component in a vector of vector would have</span>
<a name="line-57"></a><span class="cm">    had to be accessed as something like, ncomps[2][3], which is more</span>
<a name="line-58"></a><span class="cm">    error-prone to read than ncomps&lt; tag::dirichlet &gt;( 3 ). Furthermore, that</span>
<a name="line-59"></a><span class="cm">    design would have resulted in double-loops at run-time, instead of letting</span>
<a name="line-60"></a><span class="cm">    the compiler loop over the types at compile-time and do the run-time loops</span>
<a name="line-61"></a><span class="cm">    only for what is only known at run-time. Additionally, and most importantly,</span>
<a name="line-62"></a><span class="cm">    _any time a new system is introduced (or the order is changed), all</span>
<a name="line-63"></a><span class="cm">    client-code would have to be changed._</span>
<a name="line-64"></a>
<a name="line-65"></a><span class="cm">    For example client-code, see walker::Dirichlet::Dirichlet() in</span>
<a name="line-66"></a><span class="cm">    DiffEq/Dirichlet.h, or walker::Integrator::Integrator in Walker/Integrator.h.</span>
<a name="line-67"></a><span class="cm">*/</span>
<a name="line-68"></a><span class="c1">// *****************************************************************************</span>
<a name="line-69"></a><span class="cp">#ifndef SystemComponents_h</span>
<a name="line-70"></a><span class="cp">#define SystemComponents_h</span>
<a name="line-71"></a>
<a name="line-72"></a><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<a name="line-73"></a><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<a name="line-74"></a><span class="cp">#include</span> <span class="cpf">&lt;numeric&gt;</span><span class="cp"></span>
<a name="line-75"></a><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<a name="line-76"></a>
<a name="line-77"></a><span class="cp">#include</span> <span class="cpf">&lt;brigand/sequences/list.hpp&gt;</span><span class="cp"></span>
<a name="line-78"></a><span class="cp">#include</span> <span class="cpf">&lt;brigand/algorithms/wrap.hpp&gt;</span><span class="cp"></span>
<a name="line-79"></a>
<a name="line-80"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/flatten.hpp&quot;</span><span class="cp"></span>
<a name="line-81"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/transform.hpp&quot;</span><span class="cp"></span>
<a name="line-82"></a>
<a name="line-83"></a><span class="cp">#include</span> <span class="cpf">&quot;TaggedTuple.hpp&quot;</span><span class="cp"></span>
<a name="line-84"></a><span class="cp">#include</span> <span class="cpf">&quot;StatCtr.hpp&quot;</span><span class="cp"></span>
<a name="line-85"></a><span class="cp">#include</span> <span class="cpf">&quot;Keywords.hpp&quot;</span><span class="cp"></span>
<a name="line-86"></a><span class="cp">#include</span> <span class="cpf">&quot;Tags.hpp&quot;</span><span class="cp"></span>
<a name="line-87"></a>
<a name="line-88"></a><span class="k">namespace</span> <span class="n">tk</span> <span class="p">{</span>
<a name="line-89"></a><span class="c1">//! Toolkit control, general purpose user input to internal data transfer</span>
<a name="line-90"></a><span class="k">namespace</span> <span class="n">ctr</span> <span class="p">{</span>
<a name="line-91"></a>
<a name="line-92"></a><span class="c1">//! Inherit type of number of components from keyword &#39;ncomp&#39;</span>
<a name="line-93"></a><span class="k">using</span> <span class="n">ncomp_t</span> <span class="o">=</span> <span class="n">kw</span><span class="o">::</span><span class="n">ncomp</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span><span class="p">;</span>
<a name="line-94"></a>
<a name="line-95"></a><span class="c1">//! \brief Map associating number of scalar components to dependent variables</span>
<a name="line-96"></a><span class="c1">//!   for systems</span>
<a name="line-97"></a><span class="c1">//! \details This map associates the number of properties (scalar components)</span>
<a name="line-98"></a><span class="c1">//!   of systems of differential equations for all scalar components of a</span>
<a name="line-99"></a><span class="c1">//!   system of systems.</span>
<a name="line-100"></a><span class="c1">//! \note We use a case-insensitive character comparison functor to be</span>
<a name="line-101"></a><span class="c1">//!   consistent with OffsetMap.</span>
<a name="line-102"></a><span class="k">using</span> <span class="n">NcompMap</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">char</span><span class="p">,</span> <span class="n">ncomp_t</span><span class="p">,</span> <span class="n">CaseInsensitiveCharLess</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-103"></a>
<a name="line-104"></a><span class="c1">//! Helper for converting a brigand::list to a tagged_tuple</span>
<a name="line-105"></a><span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span><span class="p">...</span> <span class="n">T</span> <span class="o">&gt;</span>
<a name="line-106"></a><span class="k">using</span> <span class="n">tagged_tuple_wrapper</span> <span class="o">=</span> <span class="k">typename</span> <span class="nc">tk</span><span class="o">::</span><span class="n">TaggedTuple</span><span class="o">&lt;</span> <span class="n">brigand</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">T</span><span class="p">...</span><span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-107"></a>
<a name="line-108"></a><span class="c1">//! Helper for converting a brigand::list to a tagged_tuple</span>
<a name="line-109"></a><span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="nc">L</span> <span class="o">&gt;</span>
<a name="line-110"></a><span class="k">using</span> <span class="n">as_tagged_tuple</span> <span class="o">=</span> <span class="n">brigand</span><span class="o">::</span><span class="n">wrap</span><span class="o">&lt;</span> <span class="n">L</span><span class="p">,</span> <span class="n">tagged_tuple_wrapper</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-111"></a>
<a name="line-112"></a><span class="c1">//! Number of components storage as a vector for a system of equations</span>
<a name="line-113"></a><span class="c1">//! \details This is only a helper class, defining a type &#39;type&#39; for</span>
<a name="line-114"></a><span class="c1">//!    brigand::apply, so it can be used for defining a base for ncomponents</span>
<a name="line-115"></a><span class="k">struct</span> <span class="nc">ComponentVector</span> <span class="o">:</span> <span class="k">public</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">ncomp_t</span> <span class="o">&gt;</span> <span class="p">{</span>
<a name="line-116"></a>  <span class="k">using</span> <span class="n">type</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">ncomp_t</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-117"></a><span class="p">};</span>
<a name="line-118"></a>
<a name="line-119"></a><span class="c1">//! \brief Number of components storage</span>
<a name="line-120"></a><span class="c1">//! \details All this trickery with template meta-programming allows the code</span>
<a name="line-121"></a><span class="c1">//!   below to be generic. As a result, adding a new component requires adding a</span>
<a name="line-122"></a><span class="c1">//!   single line (a tag and its type) to the already existing list, see</span>
<a name="line-123"></a><span class="c1">//!   typedefs &#39;ncomps&#39;. The member functions, doing initialization, computing</span>
<a name="line-124"></a><span class="c1">//!   the number of total components, the offset for a given tag, and computing</span>
<a name="line-125"></a><span class="c1">//!   the offset map, need no change -- even if the order of the number of</span>
<a name="line-126"></a><span class="c1">//!   components change.</span>
<a name="line-127"></a><span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span><span class="p">...</span> <span class="n">Tags</span> <span class="o">&gt;</span>
<a name="line-128"></a><span class="k">class</span> <span class="nc">ncomponents</span> <span class="o">:</span> <span class="k">public</span>
<a name="line-129"></a>  <span class="c1">// tk::tuple::tagged_tuple&lt; tag1, vec1, tag2, vec2, ... &gt;</span>
<a name="line-130"></a>  <span class="n">as_tagged_tuple</span><span class="o">&lt;</span> <span class="n">brigand</span><span class="o">::</span><span class="n">flatten</span><span class="o">&lt;</span> <span class="n">brigand</span><span class="o">::</span><span class="n">transform</span><span class="o">&lt;</span> <span class="n">brigand</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Tags</span><span class="p">...</span><span class="o">&gt;</span><span class="p">,</span>
<a name="line-131"></a>    <span class="n">brigand</span><span class="o">::</span><span class="n">bind</span><span class="o">&lt;</span> <span class="n">brigand</span><span class="o">::</span><span class="n">list</span><span class="p">,</span> <span class="n">brigand</span><span class="o">::</span><span class="n">_1</span><span class="p">,</span> <span class="n">ComponentVector</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="p">{</span>
<a name="line-132"></a>
<a name="line-133"></a>  <span class="k">private</span><span class="o">:</span>
<a name="line-134"></a>    <span class="c1">//! Access vector of number of components of an eq system as const-ref</span>
<a name="line-135"></a>    <span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="nc">Eq</span> <span class="o">&gt;</span>
<a name="line-136"></a>    <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">vec</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span> <span class="n">Eq</span> <span class="o">&gt;</span><span class="p">();</span> <span class="p">}</span>
<a name="line-137"></a>
<a name="line-138"></a>    <span class="c1">//! Access vector of number of components of an eq system as reference</span>
<a name="line-139"></a>    <span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="nc">Eq</span> <span class="o">&gt;</span>
<a name="line-140"></a>    <span class="k">constexpr</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">vec</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span> <span class="n">Eq</span> <span class="o">&gt;</span><span class="p">();</span> <span class="p">}</span>
<a name="line-141"></a>
<a name="line-142"></a>  <span class="k">public</span><span class="o">:</span>
<a name="line-143"></a>    <span class="c1">//! Default constructor: set defaults to zero for all number of components</span>
<a name="line-144"></a>    <span class="n">ncomponents</span><span class="p">()</span> <span class="p">{</span>
<a name="line-145"></a>      <span class="p">(</span> <span class="p">...</span> <span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span> <span class="n">begin</span><span class="p">(</span><span class="n">vec</span><span class="o">&lt;</span><span class="n">Tags</span><span class="o">&gt;</span><span class="p">()),</span> <span class="n">end</span><span class="p">(</span><span class="n">vec</span><span class="o">&lt;</span><span class="n">Tags</span><span class="o">&gt;</span><span class="p">()),</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">);</span>
<a name="line-146"></a>    <span class="p">}</span>
<a name="line-147"></a>
<a name="line-148"></a>    <span class="c1">//! Compute total number of components in the systems of systems configured</span>
<a name="line-149"></a>    <span class="c1">//! \return Total number of components</span>
<a name="line-150"></a>    <span class="n">ncomp_t</span> <span class="n">nprop</span><span class="p">()</span> <span class="k">const</span> <span class="k">noexcept</span> <span class="p">{</span>
<a name="line-151"></a>      <span class="k">return</span> <span class="p">(...</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">accumulate</span><span class="p">(</span><span class="n">begin</span><span class="p">(</span><span class="n">vec</span><span class="o">&lt;</span><span class="n">Tags</span><span class="o">&gt;</span><span class="p">()),</span> <span class="n">end</span><span class="p">(</span><span class="n">vec</span><span class="o">&lt;</span><span class="n">Tags</span><span class="o">&gt;</span><span class="p">()),</span> <span class="mi">0u</span><span class="p">));</span>
<a name="line-152"></a>    <span class="p">}</span>
<a name="line-153"></a>
<a name="line-154"></a>    <span class="c1">//! \brief Compute map of number of properties (scalar components)</span>
<a name="line-155"></a>    <span class="c1">//!   associated to dependent variables</span>
<a name="line-156"></a>    <span class="c1">//! \param[in] d Input deck to operate on</span>
<a name="line-157"></a>    <span class="c1">//! \return Map of number of properties associated to dependent variables</span>
<a name="line-158"></a>    <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">InputDeck</span> <span class="o">&gt;</span>
<a name="line-159"></a>    <span class="n">NcompMap</span> <span class="n">ncompmap</span><span class="p">(</span> <span class="k">const</span> <span class="n">InputDeck</span><span class="o">&amp;</span> <span class="n">d</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
<a name="line-160"></a>      <span class="n">NcompMap</span> <span class="n">map</span><span class="p">;</span>
<a name="line-161"></a>      <span class="p">(</span> <span class="p">...</span> <span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span>
<a name="line-162"></a><span class="hll">        <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">depvar</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">Tags</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">depvar</span> <span class="o">&gt;</span><span class="p">();</span><span class="error2">&lt;--- Shadow variable</span>
</span><a name="line-163"></a>        <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">ncomps</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">component</span> <span class="o">&gt;</span><span class="p">();</span>
<a name="line-164"></a>        <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">ncvec</span> <span class="o">=</span> <span class="n">ncomps</span><span class="p">.</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span><span class="n">Tags</span><span class="o">&gt;</span><span class="p">();</span>
<a name="line-165"></a>        <span class="n">Assert</span><span class="p">(</span> <span class="n">ncvec</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="n">depvar</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="s">&quot;ncompsize != depvarsize&quot;</span> <span class="p">);</span>
<a name="line-166"></a>        <span class="n">ncomp_t</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<a name="line-167"></a>        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">v</span> <span class="p">:</span> <span class="n">depvar</span><span class="p">)</span> <span class="n">map</span><span class="p">[</span> <span class="n">v</span> <span class="p">]</span> <span class="o">=</span> <span class="n">ncvec</span><span class="p">[</span><span class="n">c</span><span class="o">++</span><span class="p">];</span> <span class="p">}()</span> <span class="p">);</span>
<a name="line-168"></a>      <span class="k">return</span> <span class="n">map</span><span class="p">;</span>
<a name="line-169"></a>    <span class="p">}</span>
<a name="line-170"></a>
<a name="line-171"></a>    <span class="c1">//! \brief Return vector of dependent variables + component id for all</span>
<a name="line-172"></a>    <span class="c1">//!   equations configured</span>
<a name="line-173"></a>    <span class="c1">//! \param[in] deck Input deck to operate on</span>
<a name="line-174"></a>    <span class="c1">//! \return Vector of dependent variables + comopnent id for all equations</span>
<a name="line-175"></a>    <span class="c1">//!   configured. The length of this vector equals the total number of</span>
<a name="line-176"></a>    <span class="c1">//!   components configured, see nprop(), containing the depvar + the</span>
<a name="line-177"></a>    <span class="c1">//!   component index relative to the given equation. E.g., c1, c2, u1, u2,</span>
<a name="line-178"></a>    <span class="c1">//!   u3, u4, u5.</span>
<a name="line-179"></a>    <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">InputDeck</span> <span class="o">&gt;</span>
<a name="line-180"></a><span class="hll">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&gt;</span> <span class="n">depvar</span><span class="p">(</span> <span class="k">const</span> <span class="n">InputDeck</span><span class="o">&amp;</span> <span class="n">deck</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="error2">&lt;--- Shadowed declaration</span>
</span><a name="line-181"></a>      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">;</span>
<a name="line-182"></a>      <span class="p">(</span> <span class="p">...,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span>
<a name="line-183"></a>        <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">dveq</span> <span class="o">=</span> <span class="n">deck</span><span class="p">.</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">Tags</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">depvar</span> <span class="o">&gt;</span><span class="p">();</span>
<a name="line-184"></a>        <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">nceq</span> <span class="o">=</span> <span class="n">deck</span><span class="p">.</span><span class="k">template</span> <span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">component</span><span class="p">,</span> <span class="n">Tags</span> <span class="o">&gt;</span><span class="p">();</span>
<a name="line-185"></a>        <span class="n">Assert</span><span class="p">(</span> <span class="n">dveq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="n">nceq</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="s">&quot;Size mismatch&quot;</span> <span class="p">);</span>
<a name="line-186"></a>        <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<a name="line-187"></a>        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">v</span> <span class="p">:</span> <span class="n">dveq</span><span class="p">)</span> <span class="p">{</span>
<a name="line-188"></a>          <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">c</span><span class="o">&lt;</span><span class="n">nceq</span><span class="p">[</span><span class="n">e</span><span class="p">];</span> <span class="o">++</span><span class="n">c</span> <span class="p">)</span>
<a name="line-189"></a>            <span class="n">d</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">v</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
<a name="line-190"></a>          <span class="o">++</span><span class="n">e</span><span class="p">;</span>
<a name="line-191"></a>        <span class="p">}</span> <span class="p">}()</span> <span class="p">);</span>
<a name="line-192"></a>      <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
<a name="line-193"></a>    <span class="p">}</span>
<a name="line-194"></a><span class="p">};</span>
<a name="line-195"></a>
<a name="line-196"></a><span class="p">}</span> <span class="c1">// ctr::</span>
<a name="line-197"></a><span class="p">}</span> <span class="c1">// tk::</span>
<a name="line-198"></a>
<a name="line-199"></a><span class="cp">#endif </span><span class="c1">// SystemComponents_h</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
