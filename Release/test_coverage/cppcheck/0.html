
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href=https://github.com/quinoacomputing/quinoa/commit/dfc2d0e79>Quinoa_v0.3-984-gdfc2d0e79</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [<a href=https://github.com/quinoacomputing/quinoa/commit/dfc2d0e79>Quinoa_v0.3-984-gdfc2d0e79</a>]: /home/apandare/TeamCity/BuildAgent2/work/65043de74745064a/src/Base/Exception.cpp</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> Exception.cpp</p>
<a href="0.html#line-49"> syntaxError 49</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/Base/Exception.cpp</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015 J. Bakosi,</span>
<a name="line-5"></a><span class="cm">             2016-2018 Los Alamos National Security, LLC.,</span>
<a name="line-6"></a><span class="cm">             2019-2021 Triad National Security, LLC.</span>
<a name="line-7"></a><span class="cm">             All rights reserved. See the LICENSE file for details.</span>
<a name="line-8"></a><span class="cm">  \brief     Exception class definition</span>
<a name="line-9"></a><span class="cm">  \details   Exception class definition</span>
<a name="line-10"></a><span class="cm">*/</span>
<a name="line-11"></a><span class="c1">// *****************************************************************************</span>
<a name="line-12"></a>
<a name="line-13"></a><span class="cp">#include</span> <span class="cpf">&lt;type_traits&gt;</span><span class="cp"></span>
<a name="line-14"></a><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp"></span>
<a name="line-15"></a><span class="cp">#include</span> <span class="cpf">&lt;cxxabi.h&gt;</span><span class="cp"></span>
<a name="line-16"></a><span class="cp">#include</span> <span class="cpf">&lt;execinfo.h&gt;</span><span class="cp"></span>
<a name="line-17"></a><span class="cp">#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<a name="line-18"></a><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<a name="line-19"></a>
<a name="line-20"></a><span class="cp">#include</span> <span class="cpf">&quot;QuinoaBuildConfig.hpp&quot;</span><span class="cp"></span>
<a name="line-21"></a><span class="cp">#include</span> <span class="cpf">&quot;Exception.hpp&quot;</span><span class="cp"></span>
<a name="line-22"></a>
<a name="line-23"></a><span class="cp">#ifdef HAS_BACKWARD</span>
<a name="line-24"></a>  <span class="cp">#include</span> <span class="cpf">&quot;NoWarning/backward.hpp&quot;</span><span class="cp"></span>
<a name="line-25"></a><span class="cp">#endif</span>
<a name="line-26"></a>
<a name="line-27"></a><span class="k">extern</span> <span class="kt">bool</span> <span class="n">g_trace</span><span class="p">;</span>
<a name="line-28"></a>
<a name="line-29"></a><span class="k">using</span> <span class="n">tk</span><span class="o">::</span><span class="n">Exception</span><span class="p">;</span>
<a name="line-30"></a>
<a name="line-31"></a><span class="n">Exception</span><span class="o">::</span><span class="n">Exception</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;&amp;</span> <span class="n">message</span><span class="p">,</span>
<a name="line-32"></a>                      <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;&amp;</span> <span class="n">file</span><span class="p">,</span>
<a name="line-33"></a>                      <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;&amp;</span> <span class="n">function</span><span class="p">,</span>
<a name="line-34"></a>                      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">line</span> <span class="p">)</span> <span class="k">noexcept</span>
<a name="line-35"></a><span class="c1">// *****************************************************************************</span>
<a name="line-36"></a><span class="c1">//  Constructor: generate error message</span>
<a name="line-37"></a><span class="c1">//! \param[in] message String (moved from) with an error message</span>
<a name="line-38"></a><span class="c1">//! \param[in] file String (moved from) with the file name in which the</span>
<a name="line-39"></a><span class="c1">//!   exception ocurred</span>
<a name="line-40"></a><span class="c1">//! \param[in] function String (moved from) containing the name of the function</span>
<a name="line-41"></a><span class="c1">//!   in which the exception ocurred</span>
<a name="line-42"></a><span class="c1">//! \param[in] line Source code line number at which the exception ocurred</span>
<a name="line-43"></a><span class="c1">//! \details While throwing exceptions is possible calling this constructor, the</span>
<a name="line-44"></a><span class="c1">//!   easiest and recommend way is to use the Assert, ErrChk, and Throw macros.</span>
<a name="line-45"></a><span class="c1">//!   Exception safety: no-throw guarantee: this member function never throws</span>
<a name="line-46"></a><span class="c1">//!   exceptions.</span>
<a name="line-47"></a><span class="c1">//! \see Assert, ErrChk, Throw</span>
<a name="line-48"></a><span class="c1">// *****************************************************************************</span>
<a name="line-49"></a><span class="hll"><span class="k">try</span> <span class="o">:</span><span class="error2">&lt;--- syntax error: keyword 'try' is not allowed in global scope</span>
</span><a name="line-50"></a>  <span class="n">m_file</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="p">),</span>
<a name="line-51"></a>  <span class="n">m_func</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">function</span><span class="p">)</span> <span class="p">),</span>
<a name="line-52"></a>  <span class="n">m_line</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="p">),</span>
<a name="line-53"></a>  <span class="n">m_message</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="p">),</span>
<a name="line-54"></a>  <span class="n">m_addrLength</span><span class="p">(</span> <span class="mi">0</span> <span class="p">),</span>
<a name="line-55"></a>  <span class="n">m_symbolList</span><span class="p">(</span> <span class="k">nullptr</span> <span class="p">)</span>
<a name="line-56"></a><span class="p">{</span>
<a name="line-57"></a>
<a name="line-58"></a>  <span class="c1">// Construct exception message</span>
<a name="line-59"></a>  <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">s</span><span class="p">;</span>
<a name="line-60"></a>  <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">m_message</span><span class="p">;</span>
<a name="line-61"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="line-62"></a>    <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&gt;&gt;&gt; Exception at &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m_file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m_line</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m_func</span><span class="p">;</span>
<a name="line-63"></a>  <span class="n">m_message</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<a name="line-64"></a>
<a name="line-65"></a>  <span class="cp">#ifdef EXCEPTIONS_WRITE_TO_CERR</span>
<a name="line-66"></a>  <span class="c1">// Uses streams (std::cerr) so it can be redirected</span>
<a name="line-67"></a>  <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&gt;&gt;&gt; Exception: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m_message</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a name="line-68"></a>  <span class="cp">#endif</span>
<a name="line-69"></a>
<a name="line-70"></a>  <span class="c1">// Save call-trace</span>
<a name="line-71"></a>  <span class="n">saveTrace</span><span class="p">();</span>
<a name="line-72"></a>
<a name="line-73"></a><span class="p">}</span> <span class="c1">// Catch std::exception</span>
<a name="line-74"></a>  <span class="k">catch</span> <span class="p">(</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">se</span><span class="p">)</span> <span class="p">{</span>
<a name="line-75"></a>    <span class="c1">// Emit warning and continue</span>
<a name="line-76"></a>    <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;RUNTIME ERROR in Exception constructor: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">se</span><span class="p">.</span><span class="n">what</span><span class="p">()</span> <span class="p">);</span>
<a name="line-77"></a>  <span class="p">}</span>
<a name="line-78"></a>  <span class="c1">// Catch uncaught exceptions</span>
<a name="line-79"></a>  <span class="k">catch</span> <span class="p">(...)</span> <span class="p">{</span>
<a name="line-80"></a>    <span class="c1">// Emit warning and continue</span>
<a name="line-81"></a>    <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;UNKNOWN EXCEPTION in Exception constructor</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<a name="line-82"></a>  <span class="p">}</span>
<a name="line-83"></a>
<a name="line-84"></a><span class="n">Exception</span><span class="o">::~</span><span class="n">Exception</span><span class="p">()</span> <span class="k">noexcept</span>
<a name="line-85"></a><span class="c1">// *****************************************************************************</span>
<a name="line-86"></a><span class="c1">//  Destructor</span>
<a name="line-87"></a><span class="c1">//! \details Exception safety: no-throw guarantee: this member function never</span>
<a name="line-88"></a><span class="c1">//!   throws exceptions.</span>
<a name="line-89"></a><span class="c1">// *****************************************************************************</span>
<a name="line-90"></a><span class="p">{</span>
<a name="line-91"></a>  <span class="c1">// allocated by execinfo.h&#39;s backtrace_symbols() in Exception::saveTrace()</span>
<a name="line-92"></a>  <span class="n">free</span><span class="p">(</span><span class="n">m_symbolList</span><span class="p">);</span>
<a name="line-93"></a><span class="p">}</span>
<a name="line-94"></a>
<a name="line-95"></a><span class="kt">void</span>
<a name="line-96"></a><span class="n">Exception</span><span class="o">::</span><span class="n">saveTrace</span><span class="p">()</span> <span class="k">noexcept</span>
<a name="line-97"></a><span class="c1">// *****************************************************************************</span>
<a name="line-98"></a><span class="c1">//  Save call-trace</span>
<a name="line-99"></a><span class="c1">//! \details Exception safety: no-throw guarantee: this member function never</span>
<a name="line-100"></a><span class="c1">//!   throws exceptions. For more information see the libc manual at</span>
<a name="line-101"></a><span class="c1">//!   http://www.gnu.org/software/libc/manual/html_node/Backtraces.html.</span>
<a name="line-102"></a><span class="c1">//!   Requires stdio.h, execinfo.h.</span>
<a name="line-103"></a><span class="c1">// *****************************************************************************</span>
<a name="line-104"></a><span class="p">{</span>
<a name="line-105"></a><span class="cp">#ifndef HOST_OS_ALPINE</span>
<a name="line-106"></a>  <span class="c1">// Retrieve current stack addresses</span>
<a name="line-107"></a>  <span class="n">m_addrLength</span> <span class="o">=</span> <span class="n">backtrace</span><span class="p">(</span><span class="n">m_addrList</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">m_addrList</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">));</span>
<a name="line-108"></a><span class="cp">#endif</span>
<a name="line-109"></a>
<a name="line-110"></a>  <span class="c1">// Resolve addresses into strings containing &quot;filename(function+address)&quot;</span>
<a name="line-111"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">m_addrLength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a name="line-112"></a>    <span class="n">m_symbolList</span> <span class="o">=</span> <span class="n">backtrace_symbols</span><span class="p">(</span><span class="n">m_addrList</span><span class="p">,</span> <span class="n">m_addrLength</span><span class="p">);</span>
<a name="line-113"></a><span class="p">}</span>
<a name="line-114"></a>
<a name="line-115"></a><span class="kt">void</span>
<a name="line-116"></a><span class="n">Exception</span><span class="o">::</span><span class="n">echoTrace</span><span class="p">()</span> <span class="k">noexcept</span>
<a name="line-117"></a><span class="c1">// *****************************************************************************</span>
<a name="line-118"></a><span class="c1">//  Demangle and echo call trace</span>
<a name="line-119"></a><span class="c1">//! \details Exception safety: no-throw guarantee: this member function never</span>
<a name="line-120"></a><span class="c1">//!   throws exceptions. Credit goes to Timo Bingmann at http://idlebox.net,</span>
<a name="line-121"></a><span class="c1">//!   published under the WTFPL v2.0. For more information see</span>
<a name="line-122"></a><span class="c1">//!   * http://panthema.net/2008/0901-stacktrace-demangled</span>
<a name="line-123"></a><span class="c1">//!   * http://panthema.net/2008/0901-stacktrace-demangled/cxa_demangle.html</span>
<a name="line-124"></a><span class="c1">//!   * http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen</span>
<a name="line-125"></a><span class="c1">// *****************************************************************************</span>
<a name="line-126"></a><span class="p">{</span>
<a name="line-127"></a>  <span class="c1">// Allocate string which will be filled with the demangled function name</span>
<a name="line-128"></a>  <span class="kt">size_t</span> <span class="n">funcnamesize</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
<a name="line-129"></a>  <span class="kt">char</span><span class="o">*</span> <span class="n">funcname</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="kt">char</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">malloc</span><span class="p">(</span><span class="n">funcnamesize</span><span class="p">)</span> <span class="p">);</span>
<a name="line-130"></a>
<a name="line-131"></a>  <span class="c1">// Iterate over the returned symbol lines. skip the first two, these are the</span>
<a name="line-132"></a>  <span class="c1">// addresses of Exception::saveTrace() and the Exception constructor</span>
<a name="line-133"></a>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m_addrLength</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<a name="line-134"></a>    <span class="kt">char</span> <span class="o">*</span><span class="n">begin_name</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">,</span> <span class="o">*</span><span class="n">begin_offset</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">,</span> <span class="o">*</span><span class="n">end_offset</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
<a name="line-135"></a>
<a name="line-136"></a>    <span class="c1">// Find parentheses and +address offset surrounding the mangled name:</span>
<a name="line-137"></a>    <span class="c1">// ./module(function+0x15c) [0x8048a6d]</span>
<a name="line-138"></a>    <span class="k">for</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">m_symbolList</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span> <span class="o">++</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
<a name="line-139"></a>      <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">==</span> <span class="sc">&#39;(&#39;</span><span class="p">)</span>
<a name="line-140"></a>        <span class="n">begin_name</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
<a name="line-141"></a>      <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">==</span> <span class="sc">&#39;+&#39;</span><span class="p">)</span>
<a name="line-142"></a>        <span class="n">begin_offset</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
<a name="line-143"></a>      <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">==</span> <span class="err">&#39;</span><span class="p">)</span><span class="err">&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">begin_offset</span><span class="p">)</span> <span class="p">{</span>
<a name="line-144"></a>        <span class="n">end_offset</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
<a name="line-145"></a>        <span class="k">break</span><span class="p">;</span>
<a name="line-146"></a>      <span class="p">}</span>
<a name="line-147"></a>    <span class="p">}</span>
<a name="line-148"></a>
<a name="line-149"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">begin_name</span> <span class="o">&amp;&amp;</span> <span class="n">begin_offset</span> <span class="o">&amp;&amp;</span> <span class="n">end_offset</span> <span class="o">&amp;&amp;</span> <span class="n">begin_name</span> <span class="o">&lt;</span> <span class="n">begin_offset</span><span class="p">)</span> <span class="p">{</span>
<a name="line-150"></a>      <span class="o">*</span><span class="n">begin_name</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a name="line-151"></a>      <span class="o">*</span><span class="n">begin_offset</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a name="line-152"></a>      <span class="o">*</span><span class="n">end_offset</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a name="line-153"></a>
<a name="line-154"></a>      <span class="c1">// Mangled name is now in [begin_name, begin_offset) and caller</span>
<a name="line-155"></a>      <span class="c1">// offset in [begin_offset, end_offset). now apply __cxa_demangle()</span>
<a name="line-156"></a>      <span class="kt">int</span> <span class="n">status</span><span class="p">;</span>
<a name="line-157"></a>      <span class="kt">char</span><span class="o">*</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">abi</span><span class="o">::</span><span class="n">__cxa_demangle</span><span class="p">(</span><span class="n">begin_name</span><span class="p">,</span>
<a name="line-158"></a>                                      <span class="n">funcname</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">funcnamesize</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">status</span><span class="p">);</span>
<a name="line-159"></a>
<a name="line-160"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<a name="line-161"></a>        <span class="n">funcname</span> <span class="o">=</span> <span class="n">ret</span><span class="p">;</span> <span class="c1">// use possibly realloc()-ed string</span>
<a name="line-162"></a>        <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt; %s : %s+%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">m_symbolList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">funcname</span><span class="p">,</span>
<a name="line-163"></a>                         <span class="n">begin_offset</span> <span class="p">);</span>
<a name="line-164"></a>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<a name="line-165"></a>        <span class="c1">// Demangling failed. Output function name as a C function with no</span>
<a name="line-166"></a>        <span class="c1">// arguments</span>
<a name="line-167"></a>        <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt; %s : %s()+%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">m_symbolList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">begin_name</span><span class="p">,</span>
<a name="line-168"></a>                         <span class="n">begin_offset</span><span class="p">);</span>
<a name="line-169"></a>      <span class="p">}</span>
<a name="line-170"></a>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<a name="line-171"></a>      <span class="c1">// Couldn&#39;t parse the line? Print the whole line</span>
<a name="line-172"></a>      <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt; %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">m_symbolList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
<a name="line-173"></a>    <span class="p">}</span>
<a name="line-174"></a>  <span class="p">}</span>
<a name="line-175"></a>
<a name="line-176"></a>  <span class="n">free</span><span class="p">(</span><span class="n">funcname</span><span class="p">);</span>
<a name="line-177"></a><span class="p">}</span>
<a name="line-178"></a>
<a name="line-179"></a><span class="n">tk</span><span class="o">::</span><span class="n">ErrCode</span>
<a name="line-180"></a><span class="n">Exception</span><span class="o">::</span><span class="n">handleException</span><span class="p">()</span> <span class="k">noexcept</span>
<a name="line-181"></a><span class="c1">// *****************************************************************************</span>
<a name="line-182"></a><span class="c1">//  Handle Exception: Print cumulative message</span>
<a name="line-183"></a><span class="c1">//! \return Error code, as defined in stdlib.h, i.e., cstdlib</span>
<a name="line-184"></a><span class="c1">//! \details Exception safety: no-throw guarantee: this member function never</span>
<a name="line-185"></a><span class="c1">//!   throws exceptions.</span>
<a name="line-186"></a><span class="c1">// *****************************************************************************</span>
<a name="line-187"></a><span class="p">{</span>
<a name="line-188"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">m_addrLength</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">g_trace</span><span class="p">)</span> <span class="p">{</span>
<a name="line-189"></a>    <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&gt;&gt;&gt; =========== CALL TRACE ===========</span><span class="se">\n</span><span class="s">&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<a name="line-190"></a>    <span class="n">echoTrace</span><span class="p">();</span>
<a name="line-191"></a>    <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&gt;&gt;&gt; ======= END OF CALL TRACE ========</span><span class="se">\n</span><span class="s">&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<a name="line-192"></a>  <span class="p">}</span>
<a name="line-193"></a>
<a name="line-194"></a>  <span class="cp">#ifdef HAS_BACKWARD</span>
<a name="line-195"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">g_trace</span><span class="p">)</span> <span class="p">{</span>
<a name="line-196"></a>    <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&gt;&gt;&gt; =========== STACK TRACE ==========</span><span class="se">\n</span><span class="s">&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<a name="line-197"></a>    <span class="k">using</span> <span class="k">namespace</span> <span class="n">backward</span><span class="p">;</span>
<a name="line-198"></a>    <span class="n">StackTrace</span> <span class="n">st</span><span class="p">;</span> <span class="n">st</span><span class="p">.</span><span class="n">load_here</span><span class="p">(</span><span class="mi">64</span><span class="p">);</span>
<a name="line-199"></a>    <span class="n">Printer</span> <span class="n">p</span><span class="p">;</span> <span class="n">p</span><span class="p">.</span><span class="n">print</span><span class="p">(</span> <span class="n">st</span><span class="p">,</span> <span class="n">stderr</span> <span class="p">);</span>
<a name="line-200"></a>    <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&gt;&gt;&gt; ======= END OF STACK TRACE =======</span><span class="se">\n</span><span class="s">&gt;&gt;&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<a name="line-201"></a>  <span class="p">}</span>
<a name="line-202"></a>  <span class="cp">#endif</span>
<a name="line-203"></a> 
<a name="line-204"></a>  <span class="k">return</span> <span class="n">tk</span><span class="o">::</span><span class="n">ErrCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<a name="line-205"></a><span class="p">}</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
